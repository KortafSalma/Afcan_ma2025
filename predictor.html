<!-- vercel final test -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>AFCON 2025 Full Tournament Bracket - Predictor</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <link href="https://fonts.googleapis.com/css2?family=Teko:wght@400;600;700&amp;family=Roboto:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>

body {
    font-family: 'Roboto', sans-serif;
    background-color: #1a0f0f;
    color: #ffffff;
    margin: 0;
    overflow-x: hidden;
}
.bg-morocco {
    background-color: #1a0f0f;
    background-image: url("https://www.transparenttextures.com/patterns/cubes.png");
    background-attachment: fixed;
}

/* Navigation Styles */
.nav-container {
    background: linear-gradient(135deg, rgba(26, 15, 15, 0.95) 0%, rgba(0, 0, 0, 0.95) 100%);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(0, 204, 102, 0.3);
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    padding: 0.5rem 1rem;
}

.nav-content {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.nav-logo {
    display: flex;
    align-items: center;
    gap: 8px;
    text-decoration: none;
}

.nav-logo-text {
    font-family: 'Teko', sans-serif;
    font-size: 1.5rem;
    font-weight: 700;
    color: white;
    letter-spacing: 1px;
}

.nav-logo-text span {
    color: #00CC66;
}

.nav-links {
    display: flex;
    gap: 1.5rem;
    align-items: center;
}

.nav-link {
    color: rgba(255, 255, 255, 0.8);
    text-decoration: none;
    font-size: 0.9rem;
    font-weight: 500;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    transition: all 0.3s ease;
    position: relative;
}

.nav-link:hover {
    color: white;
    background: rgba(0, 204, 102, 0.2);
    transform: translateY(-2px);
}

.nav-link.active {
    color: #00CC66;
    background: rgba(0, 204, 102, 0.1);
}

.nav-link.active::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 4px;
    height: 4px;
    background: #00CC66;
    border-radius: 50%;
}

.nav-mobile-toggle {
    display: none;
    background: none;
    border: none;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
}

@media (max-width: 768px) {
    .nav-mobile-toggle {
        display: block;
    }
    
    .nav-links {
        position: fixed;
        top: 60px;
        left: 0;
        right: 0;
        background: rgba(26, 15, 15, 0.98);
        backdrop-filter: blur(10px);
        flex-direction: column;
        padding: 1rem;
        gap: 0.5rem;
        border-bottom: 2px solid #00CC66;
        transform: translateY(-100%);
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
    }
    
    .nav-links.active {
        transform: translateY(0);
        opacity: 1;
        visibility: visible;
    }
    
    .nav-link {
        width: 100%;
        text-align: center;
        padding: 0.75rem 1rem;
    }
}

/* Saved Predictions Panel */
.saved-predictions-panel {
    position: fixed;
    top: 120px;
    left: 20px;
    width: 320px;
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(0, 204, 102, 0.3);
    border-radius: 12px;
    z-index: 999;
    padding: 16px;
    transform: translateX(-100%);
    transition: transform 0.3s ease;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    max-height: calc(100vh - 140px);
    overflow-y: auto;
}

.saved-predictions-panel.active {
    transform: translateX(0);
}

.saved-predictions-toggle {
    position: fixed;
    top: 120px;
    left: 0;
    background: rgba(0, 204, 102, 0.9);
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 0 12px 12px 0;
    cursor: pointer;
    z-index: 1000;
    font-weight: bold;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
}

.saved-predictions-toggle:hover {
    background: #00CC66;
    padding-left: 20px;
}

.prediction-item {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 12px;
    margin-bottom: 12px;
    transition: all 0.3s ease;
}

.prediction-item:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateX(5px);
}

.prediction-item-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.prediction-champion {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(212, 175, 55, 0.1);
    padding: 8px 12px;
    border-radius: 6px;
    margin-top: 8px;
}

.team-box {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 16px;
    background: rgba(0, 0, 0, 0.4);
    border-radius: 25px;
    border: 2px solid rgba(255, 255, 255, 0.2);
    min-width: 160px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin: 4px 0;
}

.team-box:hover {
    background: rgba(0, 0, 0, 0.6);
    transform: translateX(5px);
    border-color: #00CC66;
}

.team-box.selected {
    background: linear-gradient(135deg, rgba(0, 204, 102, 0.3) 0%, rgba(0, 204, 102, 0.6) 100%);
    border-color: #00CC66;
    box-shadow: 0 0 15px rgba(0, 204, 102, 0.4);
}

.team-box.locked {
    cursor: default;
    opacity: 0.9;
}

.team-box.locked:hover {
    transform: none;
    border-color: rgba(255, 255, 255, 0.2);
    background: rgba(0, 0, 0, 0.4);
}

.flag-icon {
    width: 24px;
    height: 18px;
    object-fit: cover;
    border-radius: 3px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

::-webkit-scrollbar {
    height: 8px;
    width: 8px;
}
::-webkit-scrollbar-track {
    background: #4a080c; 
}
::-webkit-scrollbar-thumb {
    background: #888; 
    border-radius: 4px;
}
::-webkit-scrollbar-thumb:hover {
    background: #555; 
}

/* Progress Bar */
.progress-bar {
    height: 4px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 2px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #00CC66, #D4AF37);
    transition: width 0.5s ease;
}

/* Save Animation */
@keyframes saveAnimation {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

.save-animation {
    animation: saveAnimation 0.5s ease;
}

/* Trophy Glow */
@keyframes trophyGlow {
    0% { filter: drop-shadow(0 0 5px rgba(212, 175, 55, 0.5)); }
    100% { filter: drop-shadow(0 0 20px rgba(212, 175, 55, 0.9)); }
}

.trophy-glow {
    animation: trophyGlow 2s infinite alternate;
}

/* Bracket Container */
.bracket-table {
    display: table;
    width: 100%;
    min-width: 1400px;
    position: relative;
}

.bracket-round {
    display: table-cell;
    vertical-align: top;
    position: relative;
    padding: 0 30px;
}

/* Match Container */
.match-container {
    margin: 70px 0;
    position: relative;
    min-height: 140px;
}

/* Round Labels */
.round-label {
    text-align: center;
    font-family: 'Teko', sans-serif;
    font-size: 22px;
    font-weight: bold;
    letter-spacing: 2px;
    margin-bottom: 30px;
    color: #00CC66;
    text-transform: uppercase;
}

.final-label {
    font-size: 28px;
    color: #D4AF37;
    margin-top: 80px;
}

/* Match Info */
.match-info {
    font-size: 10px;
    color: rgba(255, 255, 255, 0.6);
    margin-top: 8px;
    text-align: center;
}

/* Empty team box */
.empty-team {
    opacity: 0.3;
    border-style: dashed;
}

.empty-team .flag-placeholder {
    width: 24px;
    height: 18px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
    display: inline-block;
}

/* Screenshot Modal */
.screenshot-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.9);
    z-index: 2000;
    display: none;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

.screenshot-modal.active {
    display: flex;
}

.screenshot-container {
    background: white;
    border-radius: 12px;
    max-width: 90%;
    max-height: 90%;
    overflow: auto;
    position: relative;
}

.screenshot-buttons {
    position: absolute;
    bottom: 20px;
    right: 20px;
    display: flex;
    gap: 10px;
}

.screenshot-buttons button {
    padding: 10px 20px;
    border: none;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
}

.btn-download {
    background: #00CC66;
    color: white;
}

.btn-share {
    background: #D4AF37;
    color: black;
}

.btn-close {
    background: #c1272d;
    color: white;
}

/* Loading overlay */
.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 3000;
    flex-direction: column;
    color: white;
}

.loading-overlay.active {
    display: flex;
}

.spinner {
    border: 4px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top: 4px solid #00CC66;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
    margin-bottom: 20px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* ==================== */
/* ALL MEDIA QUERIES */
/* ==================== */

/* Tablet (769px - 1024px) */
@media (min-width: 769px) and (max-width: 1024px) {
    .bracket-table {
        min-width: 1200px;
        overflow-x: auto;
    }
    
    .bracket-round {
        padding: 0 20px;
        min-width: 180px;
    }
    
    .team-box {
        min-width: 140px;
        padding: 8px 12px;
    }
    
    .match-container {
        margin: 60px 0;
        min-height: 130px;
    }
    
    .saved-predictions-panel {
        width: 280px;
        left: 15px;
    }
    
    .trophy-glow {
        height: 200px;
    }
    
    .fixed.top-20.right-4 {
        top: 100px;
        right: 10px;
        padding: 12px;
    }
    
    .fixed.top-20.right-4 button {
        padding: 8px 12px;
        font-size: 12px;
    }
    
    header {
        padding-top: 100px;
        padding-bottom: 20px;
    }
    
    .nav-container {
        padding: 0.5rem;
    }
    
    .nav-logo-text {
        font-size: 1.3rem;
    }
    
    .round-label {
        font-size: 20px;
    }
    
    .final-label {
        font-size: 24px;
        margin-top: 70px;
    }
    
    .match-info {
        font-size: 9px;
    }
}

/* Mobile (481px - 768px) */
@media (max-width: 768px) {
    .bracket-table {
        min-width: 1200px;
        transform: scale(0.85);
        transform-origin: top left;
        margin-left: -20px;
        margin-top: -20px;
    }
    
    main {
        overflow-x: auto;
        padding: 0 10px;
    }
    
    header {
        padding-top: 80px;
        padding-bottom: 15px;
    }
    
    .header-text {
        font-size: 0.9rem;
    }
    
    .fixed.top-20.right-4 {
        position: fixed;
        top: auto;
        bottom: 15px;
        left: 10px;
        right: 10px;
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
        padding: 10px;
        gap: 8px;
    }
    
    .fixed.top-20.right-4 button {
        padding: 8px 12px;
        font-size: 11px;
        flex: 1;
        min-width: 120px;
    }
    
    .fixed.top-16 {
        top: 60px;
        padding: 8px 10px;
    }
    
    .progress-bar {
        height: 6px;
    }
    
    .trophy-glow {
        height: 150px;
    }
    
    .saved-predictions-panel {
        width: 90%;
        left: 5%;
        top: 80px;
        max-height: 70vh;
    }
    
    .saved-predictions-toggle {
        top: 80px;
        padding: 8px 12px;
        font-size: 12px;
    }
    
    .match-info {
        font-size: 8px;
    }
    
    .round-label {
        font-size: 18px;
        margin-bottom: 20px;
    }
    
    .final-label {
        font-size: 22px;
        margin-top: 60px;
    }
    
    .match-container {
        margin: 50px 0;
        min-height: 120px;
    }
    
    footer {
        padding: 15px 10px;
        font-size: 11px;
    }
    
    /* Navigation mobile */
    .nav-mobile-toggle {
        display: block;
    }
    
    .nav-links {
        position: fixed;
        top: 60px;
        left: 0;
        right: 0;
        background: rgba(26, 15, 15, 0.98);
        backdrop-filter: blur(10px);
        flex-direction: column;
        padding: 1rem;
        gap: 0.5rem;
        border-bottom: 2px solid #00CC66;
        transform: translateY(-100%);
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
    }
    
    .nav-links.active {
        transform: translateY(0);
        opacity: 1;
        visibility: visible;
    }
    
    .nav-link {
        width: 100%;
        text-align: center;
        padding: 0.75rem 1rem;
    }
}

/* Small Mobile (up to 480px) */
@media (max-width: 480px) {
    .bracket-table {
        transform: scale(0.75);
        margin-left: -40px;
        margin-top: -30px;
    }
    
    .fixed.top-20.right-4 {
        bottom: 10px;
        left: 5px;
        right: 5px;
        padding: 8px;
        gap: 5px;
    }
    
    .fixed.top-20.right-4 button {
        min-width: 110px;
        padding: 6px 10px;
        font-size: 10px;
    }
    
    header {
        padding-top: 70px;
        padding-bottom: 10px;
    }
    
    .header-text {
        font-size: 0.8rem;
    }
    
    .flex.items-center.gap-4.mb-2 {
        gap: 8px;
    }
    
    .trophy-glow {
        height: 120px;
    }
    
    .nav-logo-text {
        font-size: 1.1rem;
    }
    
    #championText {
        font-size: 12px;
        margin-top: 5px;
    }
    
    .round-label {
        font-size: 16px;
    }
    
    .final-label {
        font-size: 20px;
        margin-top: 50px;
    }
    
    .match-container {
        margin: 40px 0;
        min-height: 110px;
    }
    
    .team-box {
        min-width: 130px;
        padding: 8px 12px;
        font-size: 14px;
    }
    
    .flag-icon {
        width: 20px;
        height: 15px;
    }
    
    .saved-predictions-toggle span {
        display: none;
    }
    
    .saved-predictions-toggle {
        padding: 10px;
    }
}

/* Desktop (1025px - 1439px) */
@media (min-width: 1025px) {
    main {
        padding: 20px 40px;
    }
    
    .bracket-table {
        margin: 0 auto;
    }
    
    .team-box:hover {
        transform: translateX(8px);
        box-shadow: 0 0 20px rgba(0, 204, 102, 0.3);
    }
    
    .trophy-glow {
        transition: transform 0.5s ease;
    }
    
    .trophy-glow:hover {
        transform: scale(1.05);
    }
    
    .fixed.top-20.right-4 {
        background: rgba(0, 0, 0, 0.9);
        border: 1px solid rgba(0, 204, 102, 0.3);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
    }
    
    .saved-predictions-panel {
        transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    
    .match-container {
        margin: 80px 0;
    }
    
    .progress-bar {
        height: 6px;
    }
    
    .screenshot-container {
        max-width: 80%;
        max-height: 85%;
    }
}

/* Large Desktop (1440px and above) */
@media (min-width: 1440px) {
    .bracket-round {
        padding: 0 50px;
    }
    
    .match-container {
        margin: 90px 0;
        min-height: 160px;
    }
    
    .team-box {
        min-width: 200px;
        padding: 14px 20px;
        font-size: 16px;
    }
    
    .flag-icon {
        width: 32px;
        height: 24px;
    }
    
    .round-label {
        font-size: 26px;
        margin-bottom: 40px;
    }
    
    .final-label {
        font-size: 32px;
        margin-top: 100px;
    }
    
    #final-team1, #final-team2 {
        min-width: 220px;
        padding: 18px 28px;
    }
    
    #final-winner-box {
        min-width: 240px;
        padding: 20px 32px;
    }
    
    .trophy-glow {
        height: 280px;
    }
    
    .nav-logo-text {
        font-size: 1.8rem;
    }
    
    .nav-link {
        font-size: 1rem;
        padding: 0.75rem 1.5rem;
    }
    
    header {
        padding-top: 140px;
        padding-bottom: 40px;
    }
    
    #progressText {
        font-size: 14px;
    }
    
    .saved-predictions-panel {
        width: 350px;
    }
}

/* Extra Large Desktop (1920px and above) */
@media (min-width: 1920px) {
    .bracket-table {
        min-width: 1600px;
        max-width: 90%;
        margin: 0 auto;
    }
    
    .bracket-round {
        padding: 0 60px;
        min-width: 280px;
    }
    
    .match-container {
        margin: 100px 0;
        min-height: 180px;
    }
    
    .team-box {
        min-width: 240px;
        padding: 16px 24px;
        font-size: 18px;
    }
    
    .flag-icon {
        width: 40px;
        height: 30px;
    }
    
    .trophy-glow {
        height: 350px;
    }
    
    #final-team1, #final-team2 {
        min-width: 280px;
        padding: 20px 32px;
        font-size: 20px;
    }
    
    #final-winner-box {
        min-width: 300px;
        padding: 24px 40px;
        font-size: 22px;
    }
    
    .round-label {
        font-size: 30px;
        margin-bottom: 50px;
    }
    
    .final-label {
        font-size: 36px;
        margin-top: 120px;
    }
    
    .nav-container {
        padding: 1rem 2rem;
    }
    
    .nav-logo-text {
        font-size: 2rem;
    }
    
    .nav-link {
        font-size: 1.1rem;
        padding: 1rem 2rem;
    }
    
    header {
        padding-top: 160px;
        padding-bottom: 60px;
    }
    
    header .text-xs.text-gray-300 {
        font-size: 14px;
    }
    
    .fixed.top-20.right-4 {
        padding: 20px;
        gap: 15px;
    }
    
    .fixed.top-20.right-4 button {
        padding: 12px 24px;
        font-size: 16px;
    }
    
    .saved-predictions-panel {
        width: 400px;
        padding: 24px;
    }
}

/* Landscape Mobile (max-width: 768px and orientation: landscape) */
@media (max-width: 768px) and (orientation: landscape) {
    .bracket-table {
        transform: scale(0.7);
        margin-left: -30px;
        margin-top: -30px;
    }
    
    .trophy-glow {
        height: 40vh;
        max-height: 180px;
    }
    
    header {
        padding-top: 70px;
        padding-bottom: 5px;
    }
    
    .fixed.top-20.right-4 {
        bottom: 5px;
        padding: 8px;
        gap: 5px;
    }
    
    .fixed.top-20.right-4 button {
        min-width: auto;
        flex: 1;
    }
    
    .saved-predictions-panel {
        max-height: 80vh;
    }
}

/* Print Styles */
@media print {
    .nav-container,
    .fixed.top-20.right-4,
    .fixed.top-16,
    .saved-predictions-toggle,
    .saved-predictions-panel,
    footer,
    #screenshotModal,
    #loadingOverlay {
        display: none !important;
    }
    
    .bracket-table {
        min-width: 100% !important;
        transform: none !important;
        margin: 0 !important;
        zoom: 0.9;
    }
    
    body {
        background-color: white !important;
        color: black !important;
    }
    
    .team-box {
        background-color: white !important;
        border: 2px solid black !important;
        color: black !important;
        box-shadow: none !important;
    }
    
    .team-box.selected {
        background-color: #f0f0f0 !important;
        border: 3px solid #333 !important;
    }
    
    .trophy-glow {
        filter: grayscale(100%) !important;
        animation: none !important;
    }
    
    header {
        padding-top: 20px !important;
    }
    
    .bg-morocco {
        background: white !important;
    }
}

/* High DPI Screens */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .flag-icon {
        image-rendering: -webkit-optimize-contrast;
        image-rendering: crisp-edges;
    }
    
    .trophy-glow {
        image-rendering: -webkit-optimize-contrast;
    }
}
/* ========== HEADER STYLES FOR PREDICTOR ========== */
.nav-container {
    background: linear-gradient(135deg, rgba(26, 15, 15, 0.98) 0%, rgba(0, 0, 0, 0.98) 100%);
    backdrop-filter: blur(10px);
    border-bottom: 2px solid rgba(0, 204, 102, 0.4);
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    height: 80px;
    display: flex;
    align-items: center;
    padding: 0 20px;
}

.nav-content {
    max-width: 1400px;
    width: 100%;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* Logo Section */
.logo-section {
    display: flex;
    align-items: center;
    gap: 15px;
    text-decoration: none;
}

.logo-box {
    width: 90px;
    height: 45px;
    background: linear-gradient(135deg, #00CC66, #00994d);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 5px;
}

.logo-box img {
    width: 100%;
    height: auto;
    max-height: 35px;
    object-fit: contain;
}

.logo-text {
    font-family: 'Teko', sans-serif;
    font-size: 28px;
    font-weight: 700;
    color: white;
    letter-spacing: 0.5px;
    line-height: 1;
}

.logo-text span {
    color: #00CC66;
    display: block;
    font-size: 22px;
}

/* Navigation Links */
.nav-links {
    display: flex;
    gap: 25px;
    align-items: center;
    margin: 0;
    padding: 0;
    list-style: none;
}

.nav-item {
    position: relative;
}

.nav-link {
    color: rgba(255, 255, 255, 0.85);
    text-decoration: none;
    font-size: 15px;
    font-weight: 500;
    padding: 8px 16px;
    border-radius: 20px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.nav-link:hover {
    color: white;
    background: rgba(0, 204, 102, 0.15);
    transform: translateY(-2px);
}

.nav-link.active {
    color: #00CC66;
    background: rgba(0, 204, 102, 0.1);
    font-weight: 600;
}

.nav-link.active::after {
    content: '';
    position: absolute;
    bottom: -5px;
    left: 50%;
    transform: translateX(-50%);
    width: 6px;
    height: 6px;
    background: #00CC66;
    border-radius: 50%;
}

/* Profile Section */
.profile-section {
    display: flex;
    align-items: center;
    gap: 15px;
}

.user-info {
    text-align: right;
    display: none;
}

.user-name {
    font-size: 14px;
    font-weight: 600;
    color: white;
    margin-bottom: 2px;
    cursor: pointer;
    transition: color 0.3s ease;
}
.user-name:hover {
    color: #00CC66;
}

.user-country {
    font-size: 12px;
    color: #00CC66;
    font-weight: 500;
}

.profile-avatar {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    border: 2px solid #00CC66;
    object-fit: cover;
    cursor: pointer;
    transition: transform 0.3s ease box-shadow 0.3s ease;
}

.profile-avatar:hover {
    transform: scale(1.1);
    box-shadow: 0 0 0 3px rgba(0, 204, 102, 0.5);
}

.auth-btn {
    background: linear-gradient(135deg, #00CC66, #00994d);
    color: white;
    border: none;
    padding: 8px 20px;
    border-radius: 8px;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.auth-btn:hover {
    background: linear-gradient(135deg, #00b359, #008040);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 204, 102, 0.3);
}

/* Mobile Menu Button */
.mobile-menu-btn {
    display: none;
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
    padding: 5px;
}

/* ========== RESPONSIVE STYLES ========== */
@media (min-width: 1200px) {
    .user-info {
        display: block;
    }
}

@media (max-width: 1100px) {
    .nav-links {
        gap: 15px;
    }
    
    .nav-link {
        padding: 8px 12px;
        font-size: 14px;
    }
}

@media (max-width: 992px) {
    .nav-container {
        height: 70px;
        padding: 0 15px;
    }
    
    .logo-text {
        font-size: 24px;
    }
    
    .logo-text span {
        font-size: 20px;
    }
    
    .logo-box {
        width: 80px;
        height: 40px;
    }
}

@media (max-width: 768px) {
    .mobile-menu-btn {
        display: block;
    }
    
    .nav-links {
        position: fixed;
        top: 70px;
        left: 0;
        right: 0;
        background: rgba(26, 15, 15, 0.98);
        backdrop-filter: blur(20px);
        flex-direction: column;
        padding: 20px;
        gap: 10px;
        border-bottom: 2px solid #00CC66;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        transform: translateY(-100%);
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 999;
    }
    
    .nav-links.active {
        transform: translateY(0);
        opacity: 1;
        visibility: visible;
    }
    
    .nav-item {
        width: 100%;
    }
    
    .nav-link {
        width: 100%;
        padding: 12px 20px;
        border-radius: 10px;
        font-size: 16px;
        justify-content: center;
    }
    
    .user-info {
        display: block;
        margin-right: 10px;
    }
    
    .profile-section {
        margin-left: auto;
    }
}

@media (max-width: 480px) {
    .nav-container {
        padding: 0 10px;
        height: 65px;
    }
    
    .logo-text {
        font-size: 20px;
    }
    
    .logo-text span {
        font-size: 18px;
    }
    
    .logo-box {
        width: 70px;
        height: 35px;
    }
    
    .auth-btn {
        padding: 6px 15px;
        font-size: 13px;
    }
    
    .profile-avatar {
        width: 40px;
        height: 40px;
    }
}

/* Login Modal Styles */
.login-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.95);
    z-index: 2000;
    display: none;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

.login-modal.active {
    display: flex;
}

.login-container {
    background: rgba(26, 15, 15, 0.95);
    backdrop-filter: blur(20px);
    border: 2px solid #00CC66;
    border-radius: 15px;
    padding: 40px;
    max-width: 450px;
    width: 100%;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
}
/* ========== PROFILE HISTORY POPUP ========== */
.profile-history-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.95);
    backdrop-filter: blur(10px);
    z-index: 2000;
    justify-content: center;
    align-items: center;
    padding: 20px;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.profile-history-popup {
    background: linear-gradient(135deg, rgba(26, 15, 15, 0.95) 0%, rgba(0, 0, 0, 0.98) 100%);
    border: 2px solid rgba(0, 204, 102, 0.4);
    border-radius: 15px;
    width: 100%;
    max-width: 800px;
    max-height: 90vh;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    animation: slideUp 0.3s ease;
}

@keyframes slideUp {
    from { transform: translateY(50px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

.profile-history-header {
    background: linear-gradient(135deg, rgba(0, 204, 102, 0.2) 0%, rgba(26, 15, 15, 0.9) 100%);
    padding: 25px 30px;
    border-bottom: 1px solid rgba(0, 204, 102, 0.2);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.profile-history-header h2 {
    font-family: 'Teko', sans-serif;
    font-size: 32px;
    color: #00CC66;
    margin: 0;
}

.close-history-popup {
    background: rgba(0, 204, 102, 0.2);
    border: 1px solid rgba(0, 204, 102, 0.4);
    color: #00CC66;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.close-history-popup:hover {
    background: rgba(0, 204, 102, 0.4);
    transform: rotate(90deg);
}

.profile-history-content {
    padding: 30px;
    overflow-y: auto;
    max-height: calc(90vh - 150px);
}

.user-profile-summary {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 30px;
    padding: 20px;
    background: rgba(0, 204, 102, 0.1);
    border-radius: 12px;
    border: 1px solid rgba(0, 204, 102, 0.2);
}

.profile-history-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 3px solid #00CC66;
    object-fit: cover;
}

.profile-info {
    flex: 1;
}

.profile-info h3 {
    font-size: 24px;
    color: white;
    margin-bottom: 5px;
}

.profile-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-top: 10px;
}

.meta-item {
    display: flex;
    align-items: center;
    gap: 8px;
    color: rgba(255, 255, 255, 0.7);
    font-size: 14px;
}

.meta-item i {
    color: #00CC66;
}

.history-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin-bottom: 30px;
}

.stat-card-history {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(0, 204, 102, 0.2);
    border-radius: 10px;
    padding: 20px;
    text-align: center;
    transition: all 0.3s ease;
}

.stat-card-history:hover {
    background: rgba(0, 204, 102, 0.1);
    transform: translateY(-5px);
}

.stat-value-history {
    font-size: 32px;
    font-weight: bold;
    color: #00CC66;
    margin-bottom: 5px;
}

.stat-label-history {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.7);
    text-transform: uppercase;
    letter-spacing: 1px;
}

.history-section-title {
    font-family: 'Teko', sans-serif;
    font-size: 24px;
    color: #D4AF37;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid rgba(212, 175, 55, 0.3);
}

.history-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.history-item {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    padding: 20px;
    display: flex;
    align-items: center;
    gap: 20px;
    transition: all 0.3s ease;
}

.history-item:hover {
    background: rgba(0, 204, 102, 0.05);
    border-color: rgba(0, 204, 102, 0.3);
    transform: translateX(5px);
}

.history-item-icon {
    width: 50px;
    height: 50px;
    border-radius: 10px;
    background: rgba(0, 204, 102, 0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #00CC66;
    font-size: 20px;
    flex-shrink: 0;
}

.history-item-content {
    flex: 1;
}

.history-item-title {
    font-size: 16px;
    font-weight: 600;
    color: white;
    margin-bottom: 5px;
}

.history-item-desc {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.6);
    margin-bottom: 8px;
}

.history-item-meta {
    display: flex;
    gap: 15px;
    font-size: 12px;
    color: rgba(255, 255, 255, 0.5);
}

.history-item-date {
    display: flex;
    align-items: center;
    gap: 5px;
}

.history-item-points {
    display: flex;
    align-items: center;
    gap: 5px;
    color: #00CC66;
}
/* Add these styles to existing CSS */
.history-item.registration-item {
    border-left: 4px solid #00CC66;
    background: rgba(0, 204, 102, 0.05);
}

.history-item.login-item {
    border-left: 4px solid #D4AF37;
    background: rgba(212, 175, 55, 0.05);
}

.history-badge {
    display: inline-block;
    padding: 3px 10px;
    border-radius: 15px;
    font-size: 11px;
    font-weight: bold;
    margin-left: 10px;
    text-transform: uppercase;
}

.badge-registration {
    background: rgba(0, 204, 102, 0.2);
    color: #00CC66;
}

.badge-login {
    background: rgba(212, 175, 55, 0.2);
    color: #D4AF37;
}

.session-duration {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.5);
    margin-top: 5px;
}

.no-history {
    text-align: center;
    padding: 40px 20px;
    color: rgba(255, 255, 255, 0.5);
}

.no-history i {
    font-size: 48px;
    margin-bottom: 20px;
    color: rgba(0, 204, 102, 0.3);
}

.no-history h4 {
    font-size: 20px;
    color: white;
    margin-bottom: 10px;
}

/* Custom scrollbar for history */
.profile-history-content::-webkit-scrollbar {
    width: 8px;
}

.profile-history-content::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 4px;
}

.profile-history-content::-webkit-scrollbar-thumb {
    background: #00CC66;
    border-radius: 4px;
}

.profile-history-content::-webkit-scrollbar-thumb:hover {
    background: #00b359;
}

/* Responsive */
@media (max-width: 768px) {
    .profile-history-popup {
        max-height: 95vh;
    }
    
    .profile-history-content {
        padding: 20px;
        max-height: calc(95vh - 140px);
    }
    
    .user-profile-summary {
        flex-direction: column;
        text-align: center;
    }
    
    .profile-meta {
        justify-content: center;
    }
    
    .history-stats {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .history-item {
        flex-direction: column;
        text-align: center;
        gap: 15px;
    }
    
    .history-item-meta {
        justify-content: center;
    }
}

@media (max-width: 480px) {
    .history-stats {
        grid-template-columns: 1fr;
    }
    
    .profile-history-header h2 {
        font-size: 24px;
    }
}
    </style>
</head>
<body class="bg-morocco">
    <!-- Navigation Header -->
<!-- Navigation Header -->
<nav class="nav-container">
    <div class="nav-content">
        <!-- Logo -->
        <a href="index.html" class="logo-section">
            <div class="w-24 h-8 flex items-center justify-center bg-[#00CC66] rounded-full">
                <img src="logo1.png" alt="AFCON Logo">
            </div>
            <div class="logo-text">
                AFCON <span>2025</span>
            </div>
        </a>
        
        <!-- Navigation Links -->
        <ul class="nav-links" id="navLinks">
            <li class="nav-item">
                <a href="index.html" class="nav-link">
                    <i class="fas fa-home"></i> Home
                </a>
            </li>
            <li class="nav-item">
                <a href="predictor.html" class="nav-link active">
                    <i class="fas fa-trophy"></i> Predictions
                </a>
            </li>
            <li class="nav-item">
                <a href="teams.html" class="nav-link">
                    <i class="fas fa-users"></i> Teams
                </a>
            </li>
            <li class="nav-item">
                <a href="teams-details.html" class="nav-link">
                    <i class="fas fa-flag"></i> Team Details
                </a>
            </li>
            <li class="nav-item">
                <a href="#portfolio" class="nav-link">
                    <i class="fas fa-star"></i> Our Team
                </a>
            </li>
        </ul>
        
        <!-- Profile Section -->
        <div class="profile-section">
            <div class="user-info" id="userInfo">
                <div id="profileMiniName" class="user-name">Guest</div>
                <div id="profileMiniCountry" class="user-country">Sign in</div>
            </div>
            <img id="profileMiniAvatar" 
                 src="https://api.dicebear.com/7.x/avataaars/svg?seed=guest&backgroundColor=00CC66" 
                 alt="Profile" 
                 class="profile-avatar">
            <button id="profileMiniBtn" class="auth-btn">
                <i class="fas fa-sign-in-alt"></i> Sign In
            </button>
        </div>
        
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" id="mobileToggle">
            <i class="fas fa-bars"></i>
        </button>
    </div>
</nav>
    
    <!-- Saved Predictions Toggle -->
    <button class="saved-predictions-toggle" id="savedPredictionsToggle">
        <i class="fas fa-history"></i>
        <span>Saved Predictions</span>
    </button>
    
    <!-- Saved Predictions Panel -->
    <div class="saved-predictions-panel" id="savedPredictionsPanel">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-bold text-[#00CC66] flex items-center gap-2">
                <i class="fas fa-save"></i>
                Saved Predictions
            </h3>
            <button id="closeSavedPanel" class="text-white/60 hover:text-white">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div id="savedPredictionsList" class="space-y-3">
            <p class="text-center text-white/60 py-4">No saved predictions yet</p>
        </div>
        
        <div class="mt-4 pt-4 border-t border-white/10">
            <button id="clearAllPredictions" class="w-full bg-[#c1272d] hover:bg-[#a02025] text-white py-2 rounded-lg font-bold text-sm flex items-center justify-center gap-2">
                <i class="fas fa-trash"></i>
                Clear All Saved
            </button>
        </div>
    </div>
    
    <!-- Control Panel -->
    <div class="fixed top-20 right-4 z-50 flex gap-2 bg-black/80 backdrop-blur-md p-3 rounded-lg border border-white/10">
        <button id="saveBtn" class="bg-[#00CC66] hover:bg-[#00b359] text-white px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-2">
            <i class="fas fa-save"></i>
            <span>Save</span>
        </button>
        <button id="screenshotBtn" class="bg-[#007bff] hover:bg-[#0056b3] text-white px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-2">
            <i class="fas fa-camera"></i>
            <span>Screenshot</span>
        </button>
        <button id="resetBtn" class="bg-[#c1272d] hover:bg-[#a02025] text-white px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-2">
            <i class="fas fa-redo"></i>
            <span>Reset</span>
        </button>
        <button id="shareBtn" class="bg-[#D4AF37] hover:bg-[#b8942a] text-white px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-2">
            <i class="fas fa-share"></i>
            <span>Share</span>
        </button>
    </div>
    
    <!-- Progress Bar -->
    <div class="fixed top-16 left-0 right-0 z-40 bg-black/50 backdrop-blur-sm p-2">
        <div class="container mx-auto">
            <div class="flex justify-between items-center mb-1">
                <span class="text-xs font-bold text-[#00CC66]">YOUR PREDICTIONS</span>
                <span id="progressText" class="text-xs font-bold">0/15</span>
            </div>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill" style="width: 0%"></div>
            </div>
        </div>
    </div>
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <p>Creating screenshot...</p>
    </div>
    
    <!-- Screenshot Modal -->
    <div class="screenshot-modal" id="screenshotModal">
        <div class="screenshot-container">
            <img id="screenshotImage" alt="Screenshot" style="max-width: 100%; display: block;">
            <div class="screenshot-buttons">
                <button id="downloadScreenshot" class="btn-download">
                    <i class="fas fa-download"></i> Download
                </button>
                <button id="shareScreenshot" class="btn-share">
                    <i class="fas fa-share"></i> Share
                </button>
                <button id="closeScreenshot" class="btn-close">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
        </div>
    </div>

    <div class="absolute inset-0 bg-moroccan-pattern opacity-10 pointer-events-none z-0"></div>
    
    <header id="home" class="relative z-10 w-full text-center pt-24 pb-8">
        <div class="flex flex-col items-center justify-center gap-2">
            <div class="flex items-center gap-4 mb-2">
                <div class="bg-white px-2 py-1 rounded shadow-md">
                    <span class="text-[#1a0f0f] font-bold text-xl font-['Teko'] tracking-wide">CAF</span>
                </div>
                <div class="h-8 w-[1px] bg-white/50"></div>
                <div class="text-left leading-tight uppercase font-['Teko'] font-bold text-xl md:text-2xl tracking-wider drop-shadow-md">
                    <span class="block text-white">Africa Cup</span>
                    <span class="block text-white">Of Nations</span>
                    <span class="block text-[#00CC66]">Morocco 25</span>
                </div>
            </div>
            <div class="mt-2">
                <p class="text-xs text-gray-300">Interactive Predictor • Click teams to make your picks</p>
                <p id="championText" class="text-sm font-bold text-[#D4AF37] mt-1 hidden">Your Champion: <span id="championName"></span></p>
            </div>
        </div>
    </header>
    
    <!-- Main Content -->
    <main class="relative z-10 flex-grow w-full px-2 py-4 md:py-8 overflow-x-auto">
        <!-- Desktop Bracket -->
        <div class="bracket-table" id="bracketContainer">
            <!-- ========== LEFT SIDE ========== -->
            
            <!-- Round of 16 - Left -->
            <div class="bracket-round" style="width: 250px;">
                <div class="round-label">ROUND OF 16</div>
                
                <!-- Match 1: Mali vs Tunisia -->
                <div class="match-container">
                    <div data-match="m1" data-team="MLI" class="team-box">
                        <img alt="Mali Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/ml-flag.gif"/>
                        <span class="font-bold">MLI</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div data-match="m1" data-team="TUN" class="team-box">
                        <img alt="Tunisia Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/ts-flag.gif"/>
                        <span class="font-bold">TUN</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div class="match-info">
                        38 | 03 JAN - 20:00<br/><span class="opacity-75">STADE MOHAMMED V</span>
                    </div>
                </div>
                
                <!-- Match 2: Senegal vs Sudan -->
                <div class="match-container">
                    <div data-match="m2" data-team="SEN" class="team-box">
                        <img alt="Senegal Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/sg-flag.gif"/>
                        <span class="font-bold">SEN</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div data-match="m2" data-team="SDN" class="team-box">
                        <img alt="Sudan Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/su-flag.gif"/>
                        <span class="font-bold">SDN</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div class="match-info">
                        37 | 03 JAN - 17:00<br/><span class="opacity-75">GRAND STADE TANGER</span>
                    </div>
                </div>
                
                <!-- Match 3: Egypt vs Benin -->
                <div class="match-container">
                    <div data-match="m3" data-team="EGY" class="team-box">
                        <img alt="Egypt Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/eg-flag.gif"/>
                        <span class="font-bold">EGY</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div data-match="m3" data-team="BEN" class="team-box">
                        <img alt="Benin Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/bn-flag.gif"/>
                        <span class="font-bold">BEN</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div class="match-info">
                        41 | 05 JAN - 17:00<br/><span class="opacity-75">GRAND STADE AGADIR</span>
                    </div>
                </div>
                
                <!-- Match 4: Ivory Coast vs Burkina Faso -->
                <div class="match-container">
                    <div data-match="m4" data-team="CIV" class="team-box">
                        <img alt="Ivory Coast Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/iv-flag.gif"/>
                        <span class="font-bold">CIV</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div data-match="m4" data-team="BFA" class="team-box">
                        <img alt="Burkina Faso Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/uv-flag.gif"/>
                        <span class="font-bold">BFA</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div class="match-info">
                        44 | 06 JAN - 20:00<br/><span class="opacity-75">GRAND STADE MARRAKECH</span>
                    </div>
                </div>
            </div>
            
            <!-- Quarter Finals - Left -->
            <div class="bracket-round" style="width: 250px;">
                <div class="round-label">QUARTER FINALS</div>
                
                <!-- QF 1: Winner of Match 1 vs Winner of Match 2 -->
                <div class="match-container" style="margin-top: 100px;">
                    <div id="qf1-team1" class="team-box locked empty-team">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold">Winner M1</span>
                    </div>
                    <div id="qf1-team2" class="team-box locked empty-team">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold">Winner M2</span>
                    </div>
                    <div class="match-info">
                        45 | 09 JAN - 17:00<br/><span class="opacity-75">TANGER</span>
                    </div>
                </div>
                
                <!-- QF 2: Winner of Match 3 vs Winner of Match 4 -->
                <div class="match-container" style="margin-top: 140px;">
                    <div id="qf2-team1" class="team-box locked empty-team">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold">Winner M3</span>
                    </div>
                    <div id="qf2-team2" class="team-box locked empty-team">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold">Winner M4</span>
                    </div>
                    <div class="match-info">
                        48 | 10 JAN - 17:00<br/><span class="opacity-75">AGADIR</span>
                    </div>
                </div>
            </div>
            
            <!-- Semi Finals - Left -->
            <div class="bracket-round" style="width: 250px;">
                <div class="round-label">SEMI FINALS</div>
                
                <!-- SF 1: Winner of QF 1 vs Winner of QF 2 -->
                <div class="match-container" style="margin-top: 170px;">
                    <div id="sf1-team1" class="team-box locked empty-team" style="min-width: 180px; padding: 12px 20px;">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold text-lg">Winner QF1</span>
                    </div>
                    <div id="sf1-team2" class="team-box locked empty-team" style="min-width: 180px; padding: 12px 20px;">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold text-lg">Winner QF2</span>
                    </div>
                    <div class="match-info">
                        49 | 14 JAN - 18:00<br/><span class="opacity-75">TANGER</span>
                    </div>
                </div>
            </div>
            
            <!-- ========== FINAL CENTER ========== -->
            <div class="bracket-round" style="width: 400px; text-align: center;">
                <div class="round-label final-label">GRAND FINAL</div>
                
                <div class="text-center mb-8">
                    <div class="text-lg font-bold">52 | 18 JAN - 20:00</div>
                    <div class="text-sm text-[#00CC66] font-medium">COMPLEXE SPORTIF PRINCE MOULAY ABDELLAH</div>
                    <div class="text-xs text-white/60">RABAT</div>
                </div>
                
                <!-- Final Teams -->
                <div class="flex items-center justify-center gap-6 mb-6">
                    <!-- Final Team 1 -->
                    <div id="final-team1" class="team-box locked empty-team" style="min-width: 180px; padding: 14px 24px; border-width: 3px;">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold text-xl">Winner SF1</span>
                    </div>
                    
                    <div class="text-xl font-bold text-[#D4AF37]">VS</div>
                    
                    <!-- Final Team 2 -->
                    <div id="final-team2" class="team-box locked empty-team" style="min-width: 180px; padding: 14px 24px; border-width: 3px;">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold text-xl">Winner SF2</span>
                    </div>
                </div>
                
                <!-- Champion Selection -->
                <div class="mt-6">
                    <div id="final-winner-box" class="team-box locked empty-team" style="min-width: 200px; padding: 16px 28px; border: 3px solid #D4AF37; background: rgba(212, 175, 55, 0.1);">
                        <div class="flag-placeholder"></div>
                        <span id="final-winner" class="font-bold text-xl">Select Champion</span>
                    </div>
                </div>
                
                <!-- Trophy -->
                <div class="relative z-10 mb-8 transform hover:scale-105 transition duration-500 mt-8 flex justify-center items-center">
                    <div class="absolute inset-0 bg-[#D4AF37]/20 blur-3xl rounded-full"></div>
                        <img alt="AFCON Trophy" class="h-56 object-contain drop-shadow-2xl relative z-10 trophy-glow mx-auto" src="can.png"/>
                </div>
                
                <!-- Third Place Match -->
                <div class="mt-8">
                    <div class="text-sm font-bold tracking-widest text-white/80 mb-3">3rd Place</div>
                    <div class="flex items-center justify-center gap-4">
                        <div id="third-team1" class="team-box locked empty-team">
                            <div class="flag-placeholder"></div>
                            <span class="font-bold">Loser SF1</span>
                        </div>
                        <div class="text-xs text-center">
                            <span class="block font-bold">51 | 17 JAN - 17:00</span>
                            <span class="text-white/50">CASABLANCA</span>
                        </div>
                        <div id="third-team2" class="team-box locked empty-team">
                            <div class="flag-placeholder"></div>
                            <span class="font-bold">Loser SF2</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ========== RIGHT SIDE ========== -->
            
            <!-- Semi Finals - Right -->
            <div class="bracket-round" style="width: 250px;">
                <div class="round-label">SEMI FINALS</div>
                
                <!-- SF 2: Winner of QF 3 vs Winner of QF 4 -->
                <div class="match-container" style="margin-top: 170px;">
                    <div id="sf2-team1" class="team-box locked empty-team" style="min-width: 180px; padding: 12px 20px;">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold text-lg">Winner QF3</span>
                    </div>
                    <div id="sf2-team2" class="team-box locked empty-team" style="min-width: 180px; padding: 12px 20px;">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold text-lg">Winner QF4</span>
                    </div>
                    <div class="match-info">
                        50 | 14 JAN - 21:00<br/><span class="opacity-75">RABAT</span>
                    </div>
                </div>
            </div>
            
            <!-- Quarter Finals - Right -->
            <div class="bracket-round" style="width: 250px;">
                <div class="round-label">QUARTER FINALS</div>
                
                <!-- QF 3: Winner of Match 5 vs Winner of Match 6 -->
                <div class="match-container" style="margin-top: 100px;">
                    <div id="qf3-team1" class="team-box locked empty-team">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold">Winner M5</span>
                    </div>
                    <div id="qf3-team2" class="team-box locked empty-team">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold">Winner M6</span>
                    </div>
                    <div class="match-info">
                        47 | 09 JAN - 20:00<br/><span class="opacity-75">MARRAKECH</span>
                    </div>
                </div>
                
                <!-- QF 4: Winner of Match 7 vs Winner of Match 8 -->
                <div class="match-container" style="margin-top: 140px;">
                    <div id="qf4-team1" class="team-box locked empty-team">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold">Winner M7</span>
                    </div>
                    <div id="qf4-team2" class="team-box locked empty-team">
                        <div class="flag-placeholder"></div>
                        <span class="font-bold">Winner M8</span>
                    </div>
                    <div class="match-info">
                        46 | 10 JAN - 20:00<br/><span class="opacity-75">RABAT</span>
                    </div>
                </div>
            </div>
            
            <!-- Round of 16 - Right -->
            <div class="bracket-round" style="width: 250px;">
                <div class="round-label">ROUND OF 16</div>
                
                <!-- Match 5: Algeria vs DR Congo -->
                <div class="match-container">
                    <div data-match="m5" data-team="ALG" class="team-box">
                        <img alt="Algeria Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/ag-flag.gif"/>
                        <span class="font-bold">ALG</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div data-match="m5" data-team="COD" class="team-box">
                        <img alt="DR Congo Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/congo-flag.gif"/>
                        <span class="font-bold">COD</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div class="match-info">
                        43 | 06 JAN - 17:00<br/><span class="opacity-75">PRINCE MOULAY HASSAN</span>
                    </div>
                </div>
                
                <!-- Match 6: Nigeria vs Mozambique -->
                <div class="match-container">
                    <div data-match="m6" data-team="NGA" class="team-box">
                        <img alt="Nigeria Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/ni-flag.gif"/>
                        <span class="font-bold">NGA</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div data-match="m6" data-team="MOZ" class="team-box">
                        <img alt="Mozambique Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/mz-flag.gif"/>
                        <span class="font-bold">MOZ</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div class="match-info">
                        42 | 05 JAN - 20:00<br/><span class="opacity-75">COMPLEXE FES</span>
                    </div>
                </div>
                
                <!-- Match 7: South Africa vs Cameroon -->
                <div class="match-container">
                    <div data-match="m7" data-team="RSA" class="team-box">
                        <img alt="South Africa Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/small/tn_sf-flag.gif    "/>
                        <span class="font-bold">RSA</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div data-match="m7" data-team="CMR" class="team-box">
                        <img alt="Cameroon Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/small/tn_cm-flag.gif"/>
                        <span class="font-bold">CMR</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div class="match-info">
                        40 | 04 JAN - 20:00<br/><span class="opacity-75">AL MEDINA RABAT</span>
                    </div>
                </div>
                
                <!-- Match 8: Morocco vs Tanzania -->
                <div class="match-container">
                    <div data-match="m8" data-team="MAR" class="team-box">
                        <img alt="Morocco Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/mo-flag.gif"/>
                        <span class="font-bold">MAR</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div data-match="m8" data-team="TAN" class="team-box">
                        <img alt="Tanzania Flag" class="flag-icon" src="https://www.worldometers.info/img/flags/small/tn_tz-flag.gif"/>
                        <span class="font-bold">TAN</span>
                        <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                    </div>
                    <div class="match-info">
                        39 | 04 JAN - 17:00<br/><span class="opacity-75">PRINCE MOULAY ABDELLAH</span>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Login Modal -->
<div class="login-modal" id="loginModal">
    <div class="login-container">
        <div class="flex justify-between items-center mb-8">
            <h3 class="text-2xl font-bold text-[#00CC66]">Sign In / Register</h3>
            <button id="closeLoginModal" class="text-white/60 hover:text-white text-2xl transition">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <form id="loginForm" class="space-y-6">
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-3">Your Name</label>
                <input type="text" id="userName" class="w-full bg-black/50 border border-white/20 rounded-lg px-5 py-4 text-white focus:border-[#00CC66] focus:outline-none transition" placeholder="Enter your name" required>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-3">Your Country</label>
                <select id="userCountrySelect" class="w-full bg-black/50 border border-white/20 rounded-lg px-5 py-4 text-white focus:border-[#00CC66] focus:outline-none transition" required>
                    <option value="">Select your country</option>
                    <option value="Morocco">Morocco</option>
                    <option value="Algeria">Algeria</option>
                    <option value="Egypt">Egypt</option>
                    <option value="Senegal">Senegal</option>
                    <option value="Nigeria">Nigeria</option>
                    <option value="Ivory Coast">Ivory Coast</option>
                    <option value="South Africa">South Africa</option>
                    <option value="Ghana">Ghana</option>
                    <option value="Tunisia">Tunisia</option>
                    <option value="Cameroon">Cameroon</option>
                    <option value="Other">Other African Country</option>
                    <option value="International">International Fan</option>
                </select>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-3">Password</label>
                <input type="password" id="userPassword" class="w-full bg-black/50 border border-white/20 rounded-lg px-5 py-4 text-white focus:border-[#00CC66] focus:outline-none transition" placeholder="Enter password (optional)">
                <p class="text-xs text-gray-400 mt-2">
                    If you're admin, enter: admin / afcon2025admin
                </p>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-3">Favorite Team (Optional)</label>
                <select id="userFavoriteTeam" class="w-full bg-black/50 border border-white/20 rounded-lg px-5 py-4 text-white focus:border-[#00CC66] focus:outline-none transition">
                    <option value="">Select your favorite team</option>
                    <option value="MAR">Morocco</option>
                    <option value="ALG">Algeria</option>
                    <option value="EGY">Egypt</option>
                    <option value="SEN">Senegal</option>
                    <option value="NGA">Nigeria</option>
                    <option value="CIV">Ivory Coast</option>
                    <option value="RSA">South Africa</option>
                    <option value="GHA">Ghana</option>
                    <option value="TUN">Tunisia</option>
                    <option value="CMR">Cameroon</option>
                </select>
            </div>
            
            <div class="pt-6">
                <button type="submit" class="w-full bg-gradient-to-r from-[#00CC66] to-[#00994d] hover:from-[#00b359] hover:to-[#008040] text-white py-4 rounded-lg font-bold text-lg transition-all duration-300 shadow-lg hover:shadow-xl">
                    Save Profile
                </button>
            </div>
            
            <p class="text-center text-gray-400 text-sm mt-6">
                Your data is stored locally in your browser. No account required!
            </p>
        </form>
    </div>
</div>

<!-- Admin Indicator (Shows when admin is logged in) -->
<div id="adminIndicator" style="position: fixed; top: 100px; right: 20px; z-index: 9999; display: none;">
    <div style="background: #D4AF37; color: black; padding: 10px 15px; border-radius: 5px; font-weight: bold; font-size: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
        <i class="fas fa-shield-alt"></i> Admin Mode
        <button onclick="window.location.href='admin.html'" style="margin-left: 10px; background: black; color: white; border: none; padding: 4px 10px; border-radius: 3px; cursor: pointer; font-size: 11px;">
            Dashboard
        </button>
        <button onclick="logoutUser()" style="margin-left: 5px; background: #c1272d; color: white; border: none; padding: 4px 10px; border-radius: 3px; cursor: pointer; font-size: 11px;">
            Logout
        </button>
    </div>
</div>

    <footer class="relative z-10 w-full text-center py-6 bg-black/30 backdrop-blur-sm border-t border-white/10 mt-auto">
        <p class="text-sm font-bold tracking-widest text-white/80 uppercase">All kick-off times are in the local time of Morocco</p>
    </footer>
    <!-- Profile History Popup -->
<div class="profile-history-overlay" id="profileHistoryOverlay">
    <div class="profile-history-popup">
        <div class="profile-history-header">
            <h2>Profile History</h2>
            <button class="close-history-popup" id="closeHistoryPopup">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="profile-history-content" id="profileHistoryContent">
            <!-- Content will be populated by JavaScript -->
        </div>
    </div>
</div>

    <!-- Font Awesome for Icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

    <script>
        // ALL AFCON 2025 TEAMS
        // Update Flags//
        const allTeams = [
            { code: 'MLI', name: 'Mali', flag: 'https://www.worldometers.info/img/flags/ml-flag.gif' },
            { code: 'TUN', name: 'Tunisia', flag: 'https://www.worldometers.info/img/flags/ts-flag.gif' },
            { code: 'SEN', name: 'Senegal', flag: 'https://www.worldometers.info/img/flags/sg-flag.gif' },
            { code: 'SDN', name: 'Sudan', flag: 'https://www.worldometers.info/img/flags/su-flag.gif' },
            { code: 'EGY', name: 'Egypt', flag: 'https://www.worldometers.info/img/flags/eg-flag.gif' },
            { code: 'BEN', name: 'Benin', flag: 'https://www.worldometers.info/img/flags/bn-flag.gif' },
            { code: 'CIV', name: 'Ivory Coast', flag: 'https://www.worldometers.info/img/flags/iv-flag.gif' },
            { code: 'BFA', name: 'Burkina Faso', flag: 'https://www.worldometers.info/img/flags/uv-flag.gif' },
            { code: 'ALG', name: 'Algeria', flag: 'https://www.worldometers.info/img/flags/ag-flag.gif' },
            { code: 'COD', name: 'DR Congo', flag: 'https://www.worldometers.info/img/flags/congo-flag.gif' },
            { code: 'NGA', name: 'Nigeria', flag: 'https://www.worldometers.info/img/flags/ni-flag.gif' },
            { code: 'MOZ', name: 'Mozambique', flag: 'https://www.worldometers.info/img/flags/mz-flag.gif' },
            { code: 'RSA', name: 'South Africa', flag: 'https://www.worldometers.info/img/flags/small/tn_sf-flag.gif' },
            { code: 'CMR', name: 'Cameroon', flag: 'https://www.worldometers.info/img/flags/small/tn_cm-flag.gif' },
            { code: 'MAR', name: 'Morocco', flag: 'https://www.worldometers.info/img/flags/mo-flag.gif' },
            { code: 'TAN', name: 'Tanzania', flag: 'https://www.worldometers.info/img/flags/small/tn_tz-flag.gif' }
        ];
        //Update Flags Can2025.ma

        // Store predictions
        let predictions = {
            m1: null, m2: null, m3: null, m4: null, m5: null, m6: null, m7: null, m8: null,
            qf1: null, qf2: null, qf3: null, qf4: null,
            sf1: null, sf2: null,
            'final-team1': null, 'final-team2': null, 'final-winner': null,
            'third-team1': null, 'third-team2': null
        };

        // Match mappings
        const matchMappings = {
            'qf1': ['m1', 'm2'],
            'qf2': ['m3', 'm4'],
            'qf3': ['m5', 'm6'],
            'qf4': ['m7', 'm8'],
            'sf1': ['qf1', 'qf2'],
            'sf2': ['qf3', 'qf4']
        };

        // Saved predictions storage
        let savedPredictions = JSON.parse(localStorage.getItem('afcon2025_saved_predictions')) || [];

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            initializeRoundOf16();
            updateProgress();
            loadSavedPredictions();
        initProfileHistory();

            
            // Add event listeners for control buttons
            document.getElementById('saveBtn').addEventListener('click', savePredictions);
            document.getElementById('screenshotBtn').addEventListener('click', takeScreenshot);
            document.getElementById('resetBtn').addEventListener('click', resetAllPredictions);
            document.getElementById('shareBtn').addEventListener('click', sharePredictions);
            
            // Navigation functionality
            initializeNavigation();
            
            // Screenshot modal events
            document.getElementById('downloadScreenshot').addEventListener('click', downloadScreenshot);
            document.getElementById('shareScreenshot').addEventListener('click', shareScreenshot);
            document.getElementById('closeScreenshot').addEventListener('click', () => {
                document.getElementById('screenshotModal').classList.remove('active');
            });
            
            // Saved predictions panel events
            document.getElementById('savedPredictionsToggle').addEventListener('click', toggleSavedPredictionsPanel);
            document.getElementById('closeSavedPanel').addEventListener('click', toggleSavedPredictionsPanel);
            document.getElementById('clearAllPredictions').addEventListener('click', clearAllSavedPredictions);
        });

        // Initialize navigation
        function initializeNavigation() {
            const mobileToggle = document.getElementById('mobileToggle');
            const navLinks = document.getElementById('navLinks');
            
            // Mobile menu toggle
            if (mobileToggle && navLinks) {
                mobileToggle.addEventListener('click', function() {
                    navLinks.classList.toggle('active');
                });
            }
            
            // Update active link on click
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    // Update active class
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Close mobile menu if open
                    if (navLinks && window.innerWidth <= 768) {
                        navLinks.classList.remove('active');
                    }
                    
                    // Get the target section
                    const targetId = this.getAttribute('href');
                    if (targetId.startsWith('#')) {
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            e.preventDefault();
                            targetElement.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    }
                });
            });
            
            // Close mobile menu when clicking outside
            document.addEventListener('click', function(event) {
                const isClickInsideNav = navLinks.contains(event.target) || mobileToggle.contains(event.target);
                if (!isClickInsideNav && navLinks.classList.contains('active')) {
                    navLinks.classList.remove('active');
                }
            });
        }

        // Toggle saved predictions panel
        function toggleSavedPredictionsPanel() {
            const panel = document.getElementById('savedPredictionsPanel');
            panel.classList.toggle('active');
        }

        // Load saved predictions
        // Load saved predictions for current user
function loadSavedPredictions() {
    const savedList = document.getElementById('savedPredictionsList');
    
    // Get current user
    const userProfile = JSON.parse(localStorage.getItem('afcon2025_user_profile'));
    const adminSession = JSON.parse(localStorage.getItem('afcon2025_admin_session'));
    
    // Determine user ID
    let userId = 'guest';
    if (userProfile) {
        userId = userProfile.avatarSeed; // Use avatarSeed as unique ID
    } else if (adminSession && adminSession.loggedIn) {
        userId = adminSession.username.toLowerCase();
    }
    
    // Get user's saved predictions
    const allPredictions = JSON.parse(localStorage.getItem('afcon2025_all_predictions')) || {};
    const userPredictions = allPredictions[userId] || [];
    
    if (userPredictions.length === 0) {
        savedList.innerHTML = '<p class="text-center text-white/60 py-4">No saved predictions yet</p>';
        return;
    }
    
    savedList.innerHTML = '';
    
    userPredictions.forEach((prediction, index) => {
        const championTeam = allTeams.find(t => t.code === prediction.predictions['final-winner']);
        const date = new Date(prediction.timestamp);
        const formattedDate = date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        
        const predictionItem = document.createElement('div');
        predictionItem.className = 'prediction-item';
        predictionItem.innerHTML = `
            <div class="prediction-item-header">
                <span class="text-sm font-bold">Prediction #${index + 1}</span>
                <span class="text-xs text-white/60">${formattedDate}</span>
            </div>
            <div class="prediction-champion">
                <img src="${championTeam.flag}" alt="${championTeam.name} Flag" class="flag-icon" style="width: 20px; height: 15px;">
                <span class="font-bold text-[#D4AF37]">${championTeam.name}</span>
                <span class="ml-auto text-xs">🏆 Champion</span>
            </div>
            <div class="flex gap-2 mt-2">
                <button class="text-xs bg-[#00CC66] hover:bg-[#00b359] text-white px-3 py-1 rounded flex-1" onclick="loadPrediction(${index}, '${userId}')">
                    <i class="fas fa-eye mr-1"></i> View
                </button>
                <button class="text-xs bg-[#c1272d] hover:bg-[#a02025] text-white px-3 py-1 rounded" onclick="deletePrediction(${index}, '${userId}')">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        `;
        
        savedList.appendChild(predictionItem);
    });
}

        // Load a saved prediction
        function loadPrediction(index) {
            if (index >= 0 && index < savedPredictions.length) {
                const savedPrediction = savedPredictions[index];
                predictions = {...savedPrediction.predictions};
                
                // Update UI with loaded prediction
                resetAllPredictionsUI();
                applyPredictionsToUI();
                updateProgress();
                
                // Close panel
                toggleSavedPredictionsPanel();
                
                alert('Prediction loaded successfully!');
            }
        }

        // Delete a saved prediction
        function deletePrediction(index) {
            if (confirm('Are you sure you want to delete this prediction?')) {
                savedPredictions.splice(index, 1);
                localStorage.setItem('afcon2025_saved_predictions', JSON.stringify(savedPredictions));
                loadSavedPredictions();
            }
        }

        // Clear all saved predictions
        function clearAllSavedPredictions() {
            if (savedPredictions.length === 0) {
                alert('No saved predictions to clear.');
                return;
            }
            
            if (confirm('Are you sure you want to clear ALL saved predictions? This action cannot be undone.')) {
                savedPredictions = [];
                localStorage.setItem('afcon2025_saved_predictions', JSON.stringify(savedPredictions));
                loadSavedPredictions();
                alert('All saved predictions have been cleared.');
            }
        }

        // Apply predictions to UI
        function applyPredictionsToUI() {
            // Apply R16 predictions
            Object.keys(predictions).forEach(key => {
                if (key.startsWith('m')) {
                    const teamCode = predictions[key];
                    if (teamCode) {
                        const teamBox = document.querySelector(`[data-match="${key}"][data-team="${teamCode}"]`);
                        if (teamBox) {
                            selectRoundOf16Winner(key, teamCode, teamBox);
                        }
                    }
                }
            });
            
            // Apply QF predictions
            ['qf1', 'qf2', 'qf3', 'qf4'].forEach(qfMatch => {
                const winnerCode = predictions[qfMatch];
                if (winnerCode) {
                    const winnerBox = document.querySelector(`[id^="${qfMatch}-team"][data-team="${winnerCode}"]`);
                    if (winnerBox) {
                        selectQuarterFinalWinner(qfMatch, winnerCode, winnerBox);
                    }
                }
            });
            
            // Apply SF predictions
            ['sf1', 'sf2'].forEach(sfMatch => {
                const winnerCode = predictions[sfMatch];
                if (winnerCode) {
                    const winnerBox = document.querySelector(`[id^="${sfMatch}-team"][data-team="${winnerCode}"]`);
                    if (winnerBox) {
                        selectSemiFinalWinner(sfMatch, winnerCode, winnerBox);
                    }
                }
            });
            
            // Apply final champion
            const championCode = predictions['final-winner'];
            if (championCode) {
                const championBox = document.querySelector(`[data-team="${championCode}"]`);
                if (championBox) {
                    selectChampion(championBox);
                }
            }
        }

        // Initialize Round of 16 selections
        function initializeRoundOf16() {
            document.querySelectorAll('.team-box[data-match]').forEach(element => {
                element.addEventListener('click', function() {
                    if (this.classList.contains('locked')) return;
                    
                    const match = this.getAttribute('data-match');
                    const team = this.getAttribute('data-team');
                    selectRoundOf16Winner(match, team, this);
                });
            });
            
            // Initialize final winner selection
            document.getElementById('final-winner-box').addEventListener('click', function() {
                if (!this.classList.contains('locked')) {
                    selectChampion(this);
                }
            });
        }

        // Select winner in Round of 16
        function selectRoundOf16Winner(match, teamCode, element) {
            const team = allTeams.find(t => t.code === teamCode);
            predictions[match] = teamCode;
            
            // Update UI for this match
            document.querySelectorAll(`[data-match="${match}"]`).forEach(el => {
                el.classList.remove('selected');
                el.querySelector('.prediction-check')?.classList.add('hidden');
            });
            
            element.classList.add('selected');
            element.querySelector('.prediction-check')?.classList.remove('hidden');
            
            // Update quarter finals
            updateQuarterFinals();
            
            updateProgress();
        }

        // Update quarter finals based on R16 selections
        function updateQuarterFinals() {
            // Update each quarter final match
            Object.keys(matchMappings).forEach(qfMatch => {
                if (qfMatch.startsWith('qf')) {
                    const [match1, match2] = matchMappings[qfMatch];
                    const team1Code = predictions[match1];
                    const team2Code = predictions[match2];
                    
                    updateMatchDisplay(qfMatch, team1Code, team2Code);
                    
                    // If both teams are selected, make QF match clickable
                    if (team1Code && team2Code) {
                        enableQuarterFinalSelection(qfMatch);
                    }
                }
            });
        }

        // Update match display with actual teams
        function updateMatchDisplay(matchId, team1Code, team2Code) {
            const team1Box = document.getElementById(`${matchId}-team1`);
            const team2Box = document.getElementById(`${matchId}-team2`);
            
            if (team1Box && team1Code) {
                const team = allTeams.find(t => t.code === team1Code);
                updateTeamBox(team1Box, team);
            }
            
            if (team2Box && team2Code) {
                const team = allTeams.find(t => t.code === team2Code);
                updateTeamBox(team2Box, team);
            }
        }

        // Update a team box with team data
        function updateTeamBox(box, team) {
            box.classList.remove('empty-team');
            box.innerHTML = `
                <img src="${team.flag}" alt="${team.name} Flag" class="flag-icon">
                <span class="font-bold">${team.code}</span>
            `;
            
            // Store team data
            box.dataset.team = team.code;
            box.dataset.match = box.id.split('-')[0];
        }

        // Enable quarter final selection (make boxes clickable)
        function enableQuarterFinalSelection(qfMatch) {
            const team1Box = document.getElementById(`${qfMatch}-team1`);
            const team2Box = document.getElementById(`${qfMatch}-team2`);
            
            if (team1Box && team2Box) {
                // Remove locked class
                team1Box.classList.remove('locked');
                team2Box.classList.remove('locked');
                
                // Add click event listeners
                team1Box.addEventListener('click', function() {
                    selectQuarterFinalWinner(qfMatch, this.dataset.team, this);
                });
                
                team2Box.addEventListener('click', function() {
                    selectQuarterFinalWinner(qfMatch, this.dataset.team, this);
                });
            }
        }

        // Select winner in quarter finals
        function selectQuarterFinalWinner(match, teamCode, element) {
            const team = allTeams.find(t => t.code === teamCode);
            predictions[match] = teamCode;
            
            // Update UI for this match
            document.querySelectorAll(`[id^="${match}-team"]`).forEach(el => {
                el.classList.remove('selected');
            });
            
            element.classList.add('selected');
            
            // Update semi finals
            updateSemiFinals();
            
            updateProgress();
        }

        // Update semi finals based on QF selections
        function updateSemiFinals() {
            // Update SF1
            const qf1Winner = predictions['qf1'];
            const qf2Winner = predictions['qf2'];
            
            if (qf1Winner) {
                const team = allTeams.find(t => t.code === qf1Winner);
                updateTeamBox(document.getElementById('sf1-team1'), team);
            }
            
            if (qf2Winner) {
                const team = allTeams.find(t => t.code === qf2Winner);
                updateTeamBox(document.getElementById('sf1-team2'), team);
            }
            
            // Update SF2
            const qf3Winner = predictions['qf3'];
            const qf4Winner = predictions['qf4'];
            
            if (qf3Winner) {
                const team = allTeams.find(t => t.code === qf3Winner);
                updateTeamBox(document.getElementById('sf2-team1'), team);
            }
            
            if (qf4Winner) {
                const team = allTeams.find(t => t.code === qf4Winner);
                updateTeamBox(document.getElementById('sf2-team2'), team);
            }
            
            // Enable SF selection if both teams are available
            if (qf1Winner && qf2Winner) {
                enableSemiFinalSelection('sf1');
            }
            
            if (qf3Winner && qf4Winner) {
                enableSemiFinalSelection('sf2');
            }
            
            // Update finals
            updateFinals();
        }

        // Enable semi final selection
        function enableSemiFinalSelection(sfMatch) {
            const team1Box = document.getElementById(`${sfMatch}-team1`);
            const team2Box = document.getElementById(`${sfMatch}-team2`);
            
            if (team1Box && team2Box) {
                team1Box.classList.remove('locked');
                team2Box.classList.remove('locked');
                
                team1Box.addEventListener('click', function() {
                    selectSemiFinalWinner(sfMatch, this.dataset.team, this);
                });
                
                team2Box.addEventListener('click', function() {
                    selectSemiFinalWinner(sfMatch, this.dataset.team, this);
                });
            }
        }

        // Select winner in semi finals
        function selectSemiFinalWinner(match, teamCode, element) {
            const team = allTeams.find(t => t.code === teamCode);
            predictions[match] = teamCode;
            
            // Update UI for this match
            document.querySelectorAll(`[id^="${match}-team"]`).forEach(el => {
                el.classList.remove('selected');
            });
            
            element.classList.add('selected');
            
            // Update finals
            updateFinals();
            
            updateProgress();
        }

        // Update finals based on SF selections
        function updateFinals() {
            const sf1Winner = predictions['sf1'];
            const sf2Winner = predictions['sf2'];
            
            // Update final teams
            if (sf1Winner) {
                const team = allTeams.find(t => t.code === sf1Winner);
                updateTeamBox(document.getElementById('final-team1'), team);
            }
            
            if (sf2Winner) {
                const team = allTeams.find(t => t.code === sf2Winner);
                updateTeamBox(document.getElementById('final-team2'), team);
            }
            
            // Update third place teams
            if (sf1Winner) {
                // Find loser of SF1
                const sf1Teams = matchMappings['sf1'].map(qf => predictions[qf]);
                const sf1Loser = sf1Teams.find(teamCode => teamCode && teamCode !== sf1Winner);
                if (sf1Loser) {
                    const team = allTeams.find(t => t.code === sf1Loser);
                    updateTeamBox(document.getElementById('third-team1'), team);
                }
            }
            
            if (sf2Winner) {
                // Find loser of SF2
                const sf2Teams = matchMappings['sf2'].map(qf => predictions[qf]);
                const sf2Loser = sf2Teams.find(teamCode => teamCode && teamCode !== sf2Winner);
                if (sf2Loser) {
                    const team = allTeams.find(t => t.code === sf2Loser);
                    updateTeamBox(document.getElementById('third-team2'), team);
                }
            }
            
            // Enable final selection if both finalists are available
            if (sf1Winner && sf2Winner) {
                enableFinalSelection();
            }
        }

        // Enable final selection
        function enableFinalSelection() {
            const finalTeam1 = document.getElementById('final-team1');
            const finalTeam2 = document.getElementById('final-team2');
            const finalWinnerBox = document.getElementById('final-winner-box');
            
            if (finalTeam1 && finalTeam2) {
                finalTeam1.classList.remove('locked');
                finalTeam2.classList.remove('locked');
                
                // Make final teams clickable for champion selection
                finalTeam1.addEventListener('click', function() {
                    selectChampion(this);
                });
                
                finalTeam2.addEventListener('click', function() {
                    selectChampion(this);
                });
                
                // Also make champion box clickable
                finalWinnerBox.classList.remove('locked');
                finalWinnerBox.classList.remove('empty-team');
            }
        }

        // Select champion
        function selectChampion(element) {
            const teamCode = element.dataset.team;
            if (!teamCode) return;
            
            const team = allTeams.find(t => t.code === teamCode);
            predictions['final-winner'] = teamCode;
            
            // Update champion box
            const finalWinnerBox = document.getElementById('final-winner-box');
            finalWinnerBox.innerHTML = `
                <img src="${team.flag}" alt="${team.name} Flag" class="flag-icon">
                <span class="font-bold text-xl">${team.code}</span>
                <span class="ml-auto text-sm text-[#D4AF37]">✓</span>
            `;
            finalWinnerBox.classList.add('selected');
            
            // Show champion text
            const championText = document.getElementById('championText');
            const championName = document.getElementById('championName');
            if (championText && championName) {
                championName.textContent = team.name;
                championText.classList.remove('hidden');
            }
            
            updateProgress();
        }

        // Update progress bar
        function updateProgress() {
            const totalPredictions = 15;
            let completed = Object.values(predictions).filter(p => p !== null).length;
            
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            if (progressFill) {
                const percentage = (completed / totalPredictions) * 100;
                progressFill.style.width = `${percentage}%`;
            }
            
            if (progressText) {
                progressText.textContent = `${completed}/${totalPredictions}`;
            }
            
            if (completed === totalPredictions) {
                document.getElementById('saveBtn').classList.add('save-animation');
                setTimeout(() => {
                    document.getElementById('saveBtn').classList.remove('save-animation');
                }, 500);
            }
        }

        // Save predictions
        // Save predictions
function savePredictions() {
    const completed = Object.values(predictions).filter(p => p !== null).length;
    if (completed < 15) {
        alert(`Please complete all predictions before saving (${completed}/15 completed).`);
        return;
    }
    
    const data = {
        predictions: predictions,
        timestamp: new Date().toISOString(),
        champion: predictions['final-winner'] ? 
            allTeams.find(t => t.code === predictions['final-winner']).name : 'Not selected'
    };
    
    // Get current user
    const userProfile = JSON.parse(localStorage.getItem('afcon2025_user_profile'));
    const adminSession = JSON.parse(localStorage.getItem('afcon2025_admin_session'));
    
    // Determine user ID
    let userId = 'guest';
    if (userProfile) {
        userId = userProfile.avatarSeed;
    } else if (adminSession && adminSession.loggedIn) {
        userId = adminSession.username.toLowerCase();
    } else {
        // Guest users need to sign in
        if (confirm('Please sign in to save your predictions! Would you like to sign in now?')) {
            document.getElementById('loginModal').classList.add('active');
        }
        return;
    }
    
    // Get all predictions
    const allPredictions = JSON.parse(localStorage.getItem('afcon2025_all_predictions')) || {};
    
    // Get user's predictions
    const userPredictions = allPredictions[userId] || [];
    
    // Add new prediction
    userPredictions.unshift(data);
    
    // Keep only last 10 predictions
    if (userPredictions.length > 10) {
        userPredictions.length = 10;
    }
    
    // Save back to all predictions
    allPredictions[userId] = userPredictions;
    localStorage.setItem('afcon2025_all_predictions', JSON.stringify(allPredictions));
    
    // Update saved predictions list
    loadSavedPredictions();
    
    alert('Predictions saved successfully!');
    
    const saveBtn = document.getElementById('saveBtn');
    saveBtn.classList.add('save-animation');
    setTimeout(() => saveBtn.classList.remove('save-animation'), 500);
}

        // Reset all predictions UI (without confirmation)
        function resetAllPredictionsUI() {
            // Reset predictions object
            Object.keys(predictions).forEach(key => {
                predictions[key] = null;
            });
            
            // Reset all team boxes
            document.querySelectorAll('.team-box').forEach(box => {
                box.classList.remove('selected');
                box.classList.remove('locked');
                box.querySelector('.prediction-check')?.classList.add('hidden');
            });
            
            // Reset R16 boxes
            document.querySelectorAll('.team-box[data-match^="m"]').forEach(box => {
                const match = box.dataset.match;
                const team = box.dataset.team;
                const teamData = allTeams.find(t => t.code === team);
                box.innerHTML = `
                    <img src="${teamData.flag}" alt="${teamData.name} Flag" class="flag-icon">
                    <span class="font-bold">${teamData.code}</span>
                    <span class="ml-auto text-xs text-[#00CC66] hidden prediction-check">✓</span>
                `;
            });
            
            // Reset quarter finals to empty
            document.querySelectorAll('.team-box[id^="qf"]').forEach(box => {
                box.classList.add('locked');
                box.classList.add('empty-team');
                box.innerHTML = `
                    <div class="flag-placeholder"></div>
                    <span class="font-bold">${box.id.includes('team1') ? 'Winner ' + box.id.split('-')[0].toUpperCase().replace('QF', 'M') + '1' : 'Winner ' + box.id.split('-')[0].toUpperCase().replace('QF', 'M') + '2'}</span>
                `;
            });
            
            // Reset semi finals
            document.querySelectorAll('.team-box[id^="sf"]').forEach(box => {
                box.classList.add('locked');
                box.classList.add('empty-team');
                box.innerHTML = `
                    <div class="flag-placeholder"></div>
                    <span class="font-bold ${box.id.includes('sf1') || box.id.includes('sf2') ? 'text-lg' : ''}">${box.id.includes('team1') ? 'Winner QF1' : 'Winner QF2'}</span>
                `;
            });
            
            // Reset finals
            document.getElementById('final-team1').innerHTML = `
                <div class="flag-placeholder"></div>
                <span class="font-bold text-xl">Winner SF1</span>
            `;
            document.getElementById('final-team1').classList.add('locked', 'empty-team');
            
            document.getElementById('final-team2').innerHTML = `
                <div class="flag-placeholder"></div>
                <span class="font-bold text-xl">Winner SF2</span>
            `;
            document.getElementById('final-team2').classList.add('locked', 'empty-team');
            
            // Reset champion
            document.getElementById('final-winner-box').innerHTML = `
                <div class="flag-placeholder"></div>
                <span id="final-winner" class="font-bold text-xl">Select Champion</span>
            `;
            document.getElementById('final-winner-box').classList.add('locked', 'empty-team');
            document.getElementById('final-winner-box').classList.remove('selected');
            
            // Reset third place
            document.getElementById('third-team1').innerHTML = `
                <div class="flag-placeholder"></div>
                <span class="font-bold">Loser SF1</span>
            `;
            document.getElementById('third-team1').classList.add('locked', 'empty-team');
            
            document.getElementById('third-team2').innerHTML = `
                <div class="flag-placeholder"></div>
                <span class="font-bold">Loser SF2</span>
            `;
            document.getElementById('third-team2').classList.add('locked', 'empty-team');
            
            // Hide champion text
            document.getElementById('championText').classList.add('hidden');
            
            // Reinitialize event listeners
            initializeRoundOf16();
        }

        // Reset all predictions
        function resetAllPredictions() {
            if (confirm('Are you sure you want to reset all predictions?')) {
                resetAllPredictionsUI();
                updateProgress();
                
                alert('All predictions have been reset.');
            }
        }

        // Share predictions
        function sharePredictions() {
            const champion = predictions['final-winner'] ? 
                allTeams.find(t => t.code === predictions['final-winner']).name : 'Not selected yet';
            
            let shareText = `My AFCON 2025 Predictions:\n\n`;
            shareText += `🏆 Champion: ${champion}\n\n`;
            
            const finalist1 = predictions['final-team1'] ? 
                allTeams.find(t => t.code === predictions['final-team1']).name : 'TBD';
            const finalist2 = predictions['final-team2'] ? 
                allTeams.find(t => t.code === predictions['final-team2']).name : 'TBD';
            
            shareText += `Final: ${finalist1} vs ${finalist2}\n\n`;
            shareText += `Make your predictions: ${window.location.href}`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'My AFCON 2025 Predictions',
                    text: shareText,
                    url: window.location.href
                }).catch(console.error);
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('Predictions copied to clipboard!');
                }).catch(() => {
                    prompt('Copy your predictions:', shareText);
                });
            }
        }

        // Take screenshot
        function takeScreenshot() {
            const completed = Object.values(predictions).filter(p => p !== null).length;
            if (completed < 15) {
                alert(`Please complete all predictions before taking a screenshot (${completed}/15 completed).`);
                return;
            }
            
            const loadingOverlay = document.getElementById('loadingOverlay');
            loadingOverlay.classList.add('active');
            
            // Hide control panels and navigation for clean screenshot
            document.querySelector('.fixed.top-20.right-4').style.display = 'none';
            document.querySelector('.fixed.top-16').style.display = 'none';
            document.querySelector('.nav-container').style.display = 'none';
            document.querySelector('.saved-predictions-toggle').style.display = 'none';
            
            // Add watermark text
            const watermark = document.createElement('div');
            watermark.innerHTML = `
                <div style="position: fixed; bottom: 20px; right: 20px; background: rgba(0,0,0,0.7); color: white; padding: 10px; border-radius: 5px; font-size: 12px; z-index: 9999;">
                    AFCON 2025 Predictor • ${window.location.href}
                </div>
            `;
            document.body.appendChild(watermark);
            
            // Capture the bracket
            html2canvas(document.getElementById('bracketContainer'), {
                backgroundColor: '#1a0f0f',
                scale: 2,
                useCORS: true,
                logging: false,
                allowTaint: true
            }).then(canvas => {
                // Restore hidden elements
                document.querySelector('.fixed.top-20.right-4').style.display = '';
                document.querySelector('.fixed.top-16').style.display = '';
                document.querySelector('.nav-container').style.display = '';
                document.querySelector('.saved-predictions-toggle').style.display = '';
                document.body.removeChild(watermark);
                
                // Show screenshot in modal
                const screenshotImage = document.getElementById('screenshotImage');
                screenshotImage.src = canvas.toDataURL('image/png');
                
                const screenshotModal = document.getElementById('screenshotModal');
                screenshotModal.classList.add('active');
                
                loadingOverlay.classList.remove('active');
                
                // Store canvas for download
                window.screenshotCanvas = canvas;
            }).catch(error => {
                console.error('Screenshot error:', error);
                alert('Error creating screenshot. Please try again.');
                
                // Restore hidden elements
                document.querySelector('.fixed.top-20.right-4').style.display = '';
                document.querySelector('.fixed.top-16').style.display = '';
                document.querySelector('.nav-container').style.display = '';
                document.querySelector('.saved-predictions-toggle').style.display = '';
                if (document.body.contains(watermark)) {
                    document.body.removeChild(watermark);
                }
                
                loadingOverlay.classList.remove('active');
            });
        }

        // Download screenshot
        function downloadScreenshot() {
            if (!window.screenshotCanvas) return;
            
            const link = document.createElement('a');
            link.download = `afcon-2025-predictions-${Date.now()}.png`;
            link.href = window.screenshotCanvas.toDataURL('image/png');
            link.click();
        }

        // Share screenshot
        function shareScreenshot() {
            if (!window.screenshotCanvas) return;
            
            window.screenshotCanvas.toBlob(blob => {
                const file = new File([blob], 'afcon-predictions.png', { type: 'image/png' });
                
                if (navigator.share && navigator.canShare({ files: [file] })) {
                    navigator.share({
                        files: [file],
                        title: 'My AFCON 2025 Predictions',
                        text: 'Check out my AFCON 2025 tournament predictions!'
                    }).catch(console.error);
                } else {
                    alert('Sharing screenshots is not supported on this device/browser. You can download and share the image manually.');
                }
            }, 'image/png');
        }
    // ========================================
// USER PROFILE MANAGEMENT FOR PREDICTOR.HTML
// ========================================

let userProfile = JSON.parse(localStorage.getItem('afcon2025_user_profile')) || null;

// Update profile display function
function updateProfileDisplay() {
    const profileMiniAvatar = document.getElementById('profileMiniAvatar');
    const profileMiniName = document.getElementById('profileMiniName');
    const profileMiniCountry = document.getElementById('profileMiniCountry');
    const profileMiniBtn = document.getElementById('profileMiniBtn');
    
    const adminSession = JSON.parse(localStorage.getItem('afcon2025_admin_session'));
    const adminIndicator = document.getElementById('adminIndicator');
    
    if (adminSession && adminSession.loggedIn) {
        // Admin is logged in
        const displayName = adminSession.username;
        const avatarSeed = displayName.toLowerCase().replace(/\s/g, '');
        
        // Update mini profile
        profileMiniAvatar.src = `https://api.dicebear.com/7.x/avataaars/svg?seed=${avatarSeed}&backgroundColor=D4AF37`;
        profileMiniName.textContent = `${displayName} (Admin)`;
        profileMiniCountry.textContent = "Administrator";
        profileMiniBtn.innerHTML = '<i class="fas fa-sign-out-alt"></i> Admin Logout';
        profileMiniBtn.className = 'auth-btn bg-gradient-to-r from-[#D4AF37] to-[#b8942a]';
        
        // Show admin indicator
        if (adminIndicator) {
            adminIndicator.style.display = 'block';
        }
        
    } else if (userProfile) {
        // Regular user is logged in
        const avatarSeed = userProfile.avatarSeed;
        
        // Update mini profile
        profileMiniAvatar.src = `https://api.dicebear.com/7.x/avataaars/svg?seed=${avatarSeed}&backgroundColor=00CC66`;
        profileMiniName.textContent = userProfile.name;
        profileMiniCountry.textContent = userProfile.country;
        profileMiniBtn.innerHTML = '<i class="fas fa-sign-out-alt"></i> Sign Out';
        profileMiniBtn.className = 'auth-btn';
        
        // Hide admin indicator
        if (adminIndicator) {
            adminIndicator.style.display = 'none';
        }
        
    } else {
        // No one is logged in
        profileMiniAvatar.src = 'https://api.dicebear.com/7.x/avataaars/svg?seed=guest&backgroundColor=00CC66';
        profileMiniName.textContent = 'Guest';
        profileMiniCountry.textContent = 'Sign in';
        profileMiniBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Sign In';
        profileMiniBtn.className = 'auth-btn';
        
        // Hide admin indicator
        if (adminIndicator) {
            adminIndicator.style.display = 'none';
        }
    }
    if (profileMiniAvatar) {
    profileMiniAvatar.style.cursor = 'pointer';
}
if (profileMiniName) {
    profileMiniName.style.cursor = 'pointer';
}
}
// ========================================
// PROFILE HISTORY POPUP MANAGEMENT
// ========================================

// Function to open profile history popup
// ========================================
// PROFILE HISTORY POPUP MANAGEMENT
// ========================================

// Function to open profile history popup
function openProfileHistory() {
    const profileHistoryOverlay = document.getElementById('profileHistoryOverlay');
    const profileHistoryContent = document.getElementById('profileHistoryContent');
    
    if (!profileHistoryOverlay || !profileHistoryContent) return;
    
    // Get user data
    const userProfile = JSON.parse(localStorage.getItem('afcon2025_user_profile'));
    const allUsers = JSON.parse(localStorage.getItem('afcon2025_all_users')) || [];
    
    // Find current user in all users
    let currentUserData = null;
    if (userProfile) {
        currentUserData = allUsers.find(user => 
            user.name === userProfile.name && user.country === userProfile.country
        );
    }
    
    // Prepare history items
    const historyItems = [];
    
    // 1. Get user's actual history from storage (including registrations and logins)
    const userHistory = JSON.parse(localStorage.getItem(`afcon2025_user_history_${userProfile ? userProfile.avatarSeed : 'guest'}`)) || [];
    
    // If no history exists, create it from current data
    if (userHistory.length === 0 && currentUserData) {
        // Add initial registration
        historyItems.push({
            type: 'registration',
            title: 'Account Created',
            description: `Welcome to AFCON 2025 Hub, ${currentUserData.name}!`,
            date: new Date(currentUserData.registrationDate),
            icon: 'fa-user-plus',
            points: 0,
            action: 'signup'
        });
        
        // Add recent logins
        if (currentUserData.loginCount > 1) {
            for (let i = 1; i <= Math.min(currentUserData.loginCount, 5); i++) {
                const loginDate = new Date(currentUserData.registrationDate);
                loginDate.setDate(loginDate.getDate() + i);
                
                historyItems.push({
                    type: 'login',
                    title: 'Login Session',
                    description: 'Signed in to your account',
                    date: loginDate,
                    icon: 'fa-sign-in-alt',
                    points: 0,
                    action: 'login'
                });
            }
        }
    } else {
        // Use existing history
        historyItems.push(...userHistory);
    }
    
    // 2. Add current login if not already in history
    const today = new Date().toDateString();
    const hasTodayLogin = historyItems.some(item => 
        new Date(item.date).toDateString() === today && item.action === 'login'
    );
    
    if (!hasTodayLogin && userProfile) {
        historyItems.push({
            type: 'login',
            title: 'Current Session',
            description: 'Currently signed in',
            date: new Date(),
            icon: 'fa-user-check',
            points: 0,
            action: 'login'
        });
    }
    
    // Sort history by date (newest first)
    historyItems.sort((a, b) => new Date(b.date) - new Date(a.date));
    
    // Calculate stats
    const registrations = historyItems.filter(item => item.action === 'signup').length;
    const logins = historyItems.filter(item => item.action === 'login').length;
    const totalSessions = registrations + logins;
    
    // Build popup content
    let contentHTML = '';
    
    // User profile summary
    contentHTML += `
        <div class="user-profile-summary">
            <img src="${userProfile ? `https://api.dicebear.com/7.x/avataaars/svg?seed=${userProfile.avatarSeed}&backgroundColor=00CC66` : 'https://api.dicebear.com/7.x/avataaars/svg?seed=guest&backgroundColor=00CC66'}" 
                 alt="Profile" 
                 class="profile-history-avatar">
            <div class="profile-info">
                <h3>${userProfile ? userProfile.name : 'Guest User'}</h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 10px;">
                    ${userProfile ? `From ${userProfile.country}` : 'Sign in to track your history'}
                    ${userProfile && userProfile.favoriteTeam ? ` | Supports ${userProfile.favoriteTeam}` : ''}
                </p>
                <div class="profile-meta">
                    <div class="meta-item">
                        <i class="fas fa-calendar"></i>
                        <span>Joined: ${userProfile ? new Date(userProfile.loginDate).toLocaleDateString() : 'N/A'}</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-sign-in-alt"></i>
                        <span>Sessions: ${totalSessions}</span>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // Stats section
    contentHTML += `
        <div class="history-stats">
            <div class="stat-card-history">
                <div class="stat-value-history">${registrations}</div>
                <div class="stat-label-history">Registrations</div>
            </div>
            <div class="stat-card-history">
                <div class="stat-value-history">${logins}</div>
                <div class="stat-label-history">Login Sessions</div>
            </div>
            <div class="stat-card-history">
                <div class="stat-value-history">${totalSessions}</div>
                <div class="stat-label-history">Total Sessions</div>
            </div>
            <div class="stat-card-history">
                <div class="stat-value-history">${userProfile ? 'Active' : 'Guest'}</div>
                <div class="stat-label-history">Account Status</div>
            </div>
        </div>
    `;
    
    // History section
    contentHTML += `
        <div class="history-section-title">
            <i class="fas fa-history"></i> Connection History
        </div>
    `;
    
    if (historyItems.length > 0) {
        contentHTML += `<div class="history-list">`;
        
        // Show only registration and login history (no predictions)
        const connectionHistory = historyItems.filter(item => 
            item.action === 'signup' || item.action === 'login'
        );
        
        if (connectionHistory.length > 0) {
            connectionHistory.forEach((item, index) => {
                const isRegistration = item.action === 'signup';
                
                contentHTML += `
                    <div class="history-item" style="border-left: 4px solid ${isRegistration ? '#00CC66' : '#D4AF37'}">
                        <div class="history-item-icon" style="background: ${isRegistration ? 'rgba(0, 204, 102, 0.2)' : 'rgba(212, 175, 55, 0.2)'}; color: ${isRegistration ? '#00CC66' : '#D4AF37'}">
                            <i class="fas ${item.icon}"></i>
                        </div>
                        <div class="history-item-content">
                            <div class="history-item-title">${item.title}</div>
                            <div class="history-item-desc">${item.description}</div>
                            <div class="history-item-meta">
                                <div class="history-item-date">
                                    <i class="far fa-clock"></i>
                                    ${new Date(item.date).toLocaleDateString('en-US', { 
                                        weekday: 'long',
                                        year: 'numeric', 
                                        month: 'long', 
                                        day: 'numeric',
                                        hour: '2-digit',
                                        minute: '2-digit'
                                    })}
                                </div>
                                <div class="history-item-points" style="color: ${isRegistration ? '#00CC66' : '#D4AF37'}">
                                    <i class="fas ${isRegistration ? 'fa-user-plus' : 'fa-sign-in-alt'}"></i>
                                    ${isRegistration ? 'Registration' : 'Login'}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
        } else {
            contentHTML += `
                <div class="no-history">
                    <i class="fas fa-user-clock"></i>
                    <h4>No Connection History</h4>
                    <p>Sign in or register to start tracking your sessions</p>
                </div>
            `;
        }
        
        contentHTML += `</div>`;
    } else {
        contentHTML += `
            <div class="no-history">
                <i class="fas fa-history"></i>
                <h4>No Connection History</h4>
                <p>Your registration and login history will appear here</p>
                ${!userProfile ? `
                    <a href="javascript:void(0)" onclick="document.getElementById('loginModal').classList.add('active'); closeProfileHistory();" 
                       class="bg-gradient-to-r from-[#00CC66] to-[#00994d] hover:from-[#00b359] hover:to-[#008040] text-white px-6 py-3 rounded-lg font-bold mt-4 inline-block">
                        <i class="fas fa-user-plus"></i> Register Now
                    </a>
                ` : ''}
            </div>
        `;
    }
    
    // Update content
    profileHistoryContent.innerHTML = contentHTML;
    
    // Show popup
    profileHistoryOverlay.style.display = 'flex';
    document.body.style.overflow = 'hidden';
}

// Function to save user history when they register or login
function saveUserHistory(action, userName, userCountry) {
    if (!userName || !userCountry) return;
    
    const avatarSeed = userName.toLowerCase().replace(/\s/g, '');
    const userHistoryKey = `afcon2025_user_history_${avatarSeed}`;
    const userHistory = JSON.parse(localStorage.getItem(userHistoryKey)) || [];
    
    const historyEntry = {
        type: action === 'signup' ? 'registration' : 'login',
        title: action === 'signup' ? 'Account Created' : 'Login Session',
        description: action === 'signup' 
            ? `Welcome to AFCON 2025 Hub, ${userName}!` 
            : 'Signed in to your account',
        date: new Date().toISOString(),
        icon: action === 'signup' ? 'fa-user-plus' : 'fa-sign-in-alt',
        points: 0,
        action: action
    };
    
    // Check if this registration already exists
    if (action === 'signup') {
        const existingRegistration = userHistory.find(item => 
            item.action === 'signup' && 
            item.title === 'Account Created'
        );
        
        if (!existingRegistration) {
            userHistory.push(historyEntry);
        }
    } else {
        // For logins, only add if not already logged in today
        const today = new Date().toDateString();
        const todayLogin = userHistory.find(item => 
            item.action === 'login' && 
            new Date(item.date).toDateString() === today
        );
        
        if (!todayLogin) {
            userHistory.push(historyEntry);
        }
    }
    
    // Keep only last 20 entries
    const sortedHistory = userHistory.sort((a, b) => new Date(b.date) - new Date(a.date));
    const limitedHistory = sortedHistory.slice(0, 20);
    
    localStorage.setItem(userHistoryKey, JSON.stringify(limitedHistory));
}

// Function to close profile history popup
function closeProfileHistory() {
    const profileHistoryOverlay = document.getElementById('profileHistoryOverlay');
    if (profileHistoryOverlay) {
        profileHistoryOverlay.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
}

// Initialize profile history functionality
function initProfileHistory() {
    // Add event listener to profile avatar and name
    const profileAvatar = document.getElementById('profileMiniAvatar');
    const profileName = document.getElementById('profileMiniName');
    const closeBtn = document.getElementById('closeHistoryPopup');
    
    // Open popup when clicking on profile avatar
    if (profileAvatar) {
        profileAvatar.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            openProfileHistory();
        });
    }
    
    // Open popup when clicking on profile name
    if (profileName) {
        profileName.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            openProfileHistory();
        });
    }
    
    // Close popup when clicking close button
    if (closeBtn) {
        closeBtn.addEventListener('click', closeProfileHistory);
    }
    
    // Close popup when clicking outside
    const overlay = document.getElementById('profileHistoryOverlay');
    if (overlay) {
        overlay.addEventListener('click', function(e) {
            if (e.target === this) {
                closeProfileHistory();
            }
        });
    }
    
    // Close with Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeProfileHistory();
        }
    });
}

function logoutUser() {
    if (confirm('Are you sure you want to sign out?')) {
        // Check if it's admin
        const adminSession = JSON.parse(localStorage.getItem('afcon2025_admin_session'));
        
        if (adminSession && adminSession.loggedIn) {
            localStorage.removeItem('afcon2025_admin_session');
            alert('Admin logged out successfully.');
        } else {
            localStorage.removeItem('afcon2025_user_profile');
            userProfile = null;
            alert('You have been signed out successfully.');
        }
        
        updateProfileDisplay();
        loadSavedPredictions(); // Reload predictions (will show empty for guest)
    }
}

// ========================================
// ADMIN MANAGEMENT SYSTEM
// ========================================

// Admin credentials
const ADMIN_CREDENTIALS = {
    username: "admin",
    password: "afcon2025admin"
};

let adminLoginAttempts = 0;
const MAX_ADMIN_ATTEMPTS = 3;

// Check admin session
function checkAdminSession() {
    const adminSession = JSON.parse(localStorage.getItem('afcon2025_admin_session'));
    return adminSession && adminSession.loggedIn;
}

// Handle admin login from main form
function handleAdminLogin(username, password) {
    // Check login attempts
    if (adminLoginAttempts >= MAX_ADMIN_ATTEMPTS) {
        alert('Too many failed attempts. Admin access is temporarily locked.');
        return false;
    }
    
    // Validate credentials
    if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
        // Successful login
        adminLoginAttempts = 0;
        
        // Create admin session
        const adminSession = {
            loggedIn: true,
            username: username,
            loginTime: new Date().toISOString(),
            sessionId: 'afcon_admin_' + Date.now()
        };
        
        localStorage.setItem('afcon2025_admin_session', JSON.stringify(adminSession));
        
        // Hide any open modal
        const loginModal = document.getElementById('loginModal');
        if (loginModal) {
            loginModal.classList.remove('active');
        }
        
        alert('Admin login successful!');
        
        // Update profile display
        updateProfileDisplay();
        
        return true;
    } else {
        // Failed login
        adminLoginAttempts++;
        
        const remaining = MAX_ADMIN_ATTEMPTS - adminLoginAttempts;
        alert(`Invalid admin credentials! ${remaining} attempt(s) remaining.`);
        
        // Lock if max attempts reached
        if (adminLoginAttempts >= MAX_ADMIN_ATTEMPTS) {
            alert('Admin access locked for 5 minutes due to too many failed attempts.');
            setTimeout(() => {
                adminLoginAttempts = 0;
                alert('Admin login is now unlocked. You can try again.');
            }, 5 * 60 * 1000);
        }
        
        return false;
    }
}

// Function to track user in statistics
// Update the trackUserInStatistics function to save history
function trackUserInStatistics(userName, userCountry, favoriteTeam) {
    const allUsers = JSON.parse(localStorage.getItem('afcon2025_all_users')) || [];
    
    // Check if user already exists
    const existingUserIndex = allUsers.findIndex(user => 
        user.name.toLowerCase() === userName.toLowerCase() && 
        user.country === userCountry
    );
    
    if (existingUserIndex === -1) {
        // Add new user (registration)
        const newUser = {
            name: userName,
            country: userCountry,
            favoriteTeam: favoriteTeam,
            avatarSeed: userName.toLowerCase().replace(/\s/g, ''),
            registrationDate: new Date().toISOString(),
            lastLogin: new Date().toISOString(),
            loginCount: 1,
            isAdmin: false
        };
        allUsers.push(newUser);
        
        // Save registration history
        saveUserHistory('signup', userName, userCountry);
        
    } else {
        // Update existing user (login)
        allUsers[existingUserIndex].lastLogin = new Date().toISOString();
        allUsers[existingUserIndex].loginCount = (allUsers[existingUserIndex].loginCount || 0) + 1;
        
        // Save login history
        saveUserHistory('login', userName, userCountry);
    }
    
    localStorage.setItem('afcon2025_all_users', JSON.stringify(allUsers));
}

// ========================================
// INITIALIZATION FOR PREDICTOR.HTML
// ========================================

// Initialize profile display
document.addEventListener('DOMContentLoaded', function() {
    // Update profile display
    updateProfileDisplay();
    
    // Mobile menu toggle
    const mobileToggle = document.getElementById('mobileToggle');
    const navLinks = document.getElementById('navLinks');
    
    if (mobileToggle && navLinks) {
        mobileToggle.addEventListener('click', function() {
            navLinks.classList.toggle('active');
        });
    }
    
    // Close mobile menu when clicking a link
    document.querySelectorAll('.nav-link').forEach(link => {
        link.addEventListener('click', function() {
            if (window.innerWidth <= 768 && navLinks) {
                navLinks.classList.remove('active');
            }
        });
    });
    
    // Attach click events to login buttons
    const profileMiniBtn = document.getElementById('profileMiniBtn');
    const loginModal = document.getElementById('loginModal');
    
    // Profile button
    if (profileMiniBtn) {
        profileMiniBtn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            if (userProfile || checkAdminSession()) {
                // User or Admin is logged in, log them out
                logoutUser();
            } else {
                // User is not logged in, show login modal
                if (loginModal) {
                    loginModal.classList.add('active');
                }
            }
        });
    }
    
    // Profile avatar click
    const profileMiniAvatar = document.getElementById('profileMiniAvatar');
    if (profileMiniAvatar) {
        profileMiniAvatar.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            if (loginModal) {
                loginModal.classList.add('active');
            }
        });
    }
    
    // Close modal button
    const closeLoginModal = document.getElementById('closeLoginModal');
    if (closeLoginModal) {
        closeLoginModal.addEventListener('click', function() {
            if (loginModal) {
                loginModal.classList.remove('active');
            }
        });
    }
    
    // Close modal when clicking outside
    if (loginModal) {
        loginModal.addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.remove('active');
            }
        });
    }
    
    // Login form submission
    const loginForm = document.getElementById('loginForm');
    // In the login form submit handler, after saving profile:
if (loginForm) {
    loginForm.addEventListener('submit', function(e) {
        e.preventDefault();
        console.log('Login form submitted');
        
        const userName = document.getElementById('userName').value;
        const userCountry = document.getElementById('userCountrySelect').value;
        const userPassword = document.getElementById('userPassword').value;
        const favoriteTeam = document.getElementById('userFavoriteTeam').value;
        
        if (!userName || !userCountry) {
            alert('Please enter your name and select your country.');
            return;
        }
        
        // Check if this is admin login attempt
        if (userName.toLowerCase() === ADMIN_CREDENTIALS.username.toLowerCase() && 
            userPassword === ADMIN_CREDENTIALS.password) {
            
            // Handle admin login
            handleAdminLogin(userName, userPassword);
            this.reset();
            return;
        }
        
        // Check if this is a registration or login
        const existingProfile = JSON.parse(localStorage.getItem('afcon2025_user_profile'));
        const isNewUser = !existingProfile || 
                         (existingProfile.name !== userName || 
                          existingProfile.country !== userCountry);
        
        // Regular user registration/login
        userProfile = {
            name: userName,
            country: userCountry,
            password: userPassword,
            favoriteTeam: favoriteTeam,
            avatarSeed: userName.toLowerCase().replace(/\s/g, ''),
            loginDate: new Date().toISOString()
        };
        
        localStorage.setItem('afcon2025_user_profile', JSON.stringify(userProfile));
        
        // Update display
        updateProfileDisplay();
        
        // Close modal
        if (loginModal) {
            loginModal.classList.remove('active');
        }
        
        // Reset form
        this.reset();
        
        // Show appropriate message
        if (isNewUser) {
            alert(`Welcome to AFCON 2025 Hub, ${userName}! Your account has been created.`);
        } else {
            alert(`Welcome back, ${userName}! You're now signed in.`);
        }
        
        // Track user in statistics (this will save history)
        trackUserInStatistics(userName, userCountry, favoriteTeam);
    });
}
});

// ========================================
// UPDATED PREDICTION FUNCTIONS
// ========================================

// Load saved predictions for current user
function loadSavedPredictions() {
    const savedList = document.getElementById('savedPredictionsList');
    
    // Get current user
    const userProfile = JSON.parse(localStorage.getItem('afcon2025_user_profile'));
    const adminSession = JSON.parse(localStorage.getItem('afcon2025_admin_session'));
    
    // Determine user ID
    let userId = 'guest';
    if (userProfile) {
        userId = userProfile.avatarSeed; // Use avatarSeed as unique ID
    } else if (adminSession && adminSession.loggedIn) {
        userId = adminSession.username.toLowerCase();
    }
    
    // Get user's saved predictions
    const allPredictions = JSON.parse(localStorage.getItem('afcon2025_all_predictions')) || {};
    const userPredictions = allPredictions[userId] || [];
    
    if (userPredictions.length === 0) {
        savedList.innerHTML = '<p class="text-center text-white/60 py-4">No saved predictions yet</p>';
        return;
    }
    
    savedList.innerHTML = '';
    
    userPredictions.forEach((prediction, index) => {
        const championTeam = allTeams.find(t => t.code === prediction.predictions['final-winner']);
        const date = new Date(prediction.timestamp);
        const formattedDate = date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        
        const predictionItem = document.createElement('div');
        predictionItem.className = 'prediction-item';
        predictionItem.innerHTML = `
            <div class="prediction-item-header">
                <span class="text-sm font-bold">Prediction #${index + 1}</span>
                <span class="text-xs text-white/60">${formattedDate}</span>
            </div>
            <div class="prediction-champion">
                <img src="${championTeam.flag}" alt="${championTeam.name} Flag" class="flag-icon" style="width: 20px; height: 15px;">
                <span class="font-bold text-[#D4AF37]">${championTeam.name}</span>
                <span class="ml-auto text-xs">🏆 Champion</span>
            </div>
            <div class="flex gap-2 mt-2">
                <button class="text-xs bg-[#00CC66] hover:bg-[#00b359] text-white px-3 py-1 rounded flex-1" onclick="loadUserPrediction(${index})">
                    <i class="fas fa-eye mr-1"></i> View
                </button>
                <button class="text-xs bg-[#c1272d] hover:bg-[#a02025] text-white px-3 py-1 rounded" onclick="deleteUserPrediction(${index})">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        `;
        
        savedList.appendChild(predictionItem);
    });
}

// Load user prediction
function loadUserPrediction(index) {
    // Get current user
    const userProfile = JSON.parse(localStorage.getItem('afcon2025_user_profile'));
    const adminSession = JSON.parse(localStorage.getItem('afcon2025_admin_session'));
    
    // Determine user ID
    let userId = 'guest';
    if (userProfile) {
        userId = userProfile.avatarSeed;
    } else if (adminSession && adminSession.loggedIn) {
        userId = adminSession.username.toLowerCase();
    }
    
    // Get user's saved predictions
    const allPredictions = JSON.parse(localStorage.getItem('afcon2025_all_predictions')) || {};
    const userPredictions = allPredictions[userId] || [];
    
    if (index >= 0 && index < userPredictions.length) {
        const savedPrediction = userPredictions[index];
        predictions = {...savedPrediction.predictions};
        
        // Update UI with loaded prediction
        resetAllPredictionsUI();
        applyPredictionsToUI();
        updateProgress();
        
        // Close panel
        toggleSavedPredictionsPanel();
        
        alert('Prediction loaded successfully!');
    }
}

// Delete user prediction
function deleteUserPrediction(index) {
    // Get current user
    const userProfile = JSON.parse(localStorage.getItem('afcon2025_user_profile'));
    const adminSession = JSON.parse(localStorage.getItem('afcon2025_admin_session'));
    
    // Determine user ID
    let userId = 'guest';
    if (userProfile) {
        userId = userProfile.avatarSeed;
    } else if (adminSession && adminSession.loggedIn) {
        userId = adminSession.username.toLowerCase();
    }
    
    if (confirm('Are you sure you want to delete this prediction?')) {
        const allPredictions = JSON.parse(localStorage.getItem('afcon2025_all_predictions')) || {};
        const userPredictions = allPredictions[userId] || [];
        
        userPredictions.splice(index, 1);
        allPredictions[userId] = userPredictions;
        
        localStorage.setItem('afcon2025_all_predictions', JSON.stringify(allPredictions));
        loadSavedPredictions();
    }
}

// Clear all saved predictions for current user
function clearAllSavedPredictions() {
    // Get current user
    const userProfile = JSON.parse(localStorage.getItem('afcon2025_user_profile'));
    const adminSession = JSON.parse(localStorage.getItem('afcon2025_admin_session'));
    
    // Determine user ID
    let userId = 'guest';
    if (userProfile) {
        userId = userProfile.avatarSeed;
    } else if (adminSession && adminSession.loggedIn) {
        userId = adminSession.username.toLowerCase();
    }
    
    const allPredictions = JSON.parse(localStorage.getItem('afcon2025_all_predictions')) || {};
    const userPredictions = allPredictions[userId] || [];
    
    if (userPredictions.length === 0) {
        alert('No saved predictions to clear.');
        return;
    }
    
    if (confirm('Are you sure you want to clear ALL your saved predictions? This action cannot be undone.')) {
        allPredictions[userId] = [];
        localStorage.setItem('afcon2025_all_predictions', JSON.stringify(allPredictions));
        loadSavedPredictions();
        alert('All your saved predictions have been cleared.');
    }
}

// Update save predictions function
function savePredictions() {
    const completed = Object.values(predictions).filter(p => p !== null).length;
    if (completed < 15) {
        alert(`Please complete all predictions before saving (${completed}/15 completed).`);
        return;
    }
    
    const data = {
        predictions: predictions,
        timestamp: new Date().toISOString(),
        champion: predictions['final-winner'] ? 
            allTeams.find(t => t.code === predictions['final-winner']).name : 'Not selected'
    };
    
    // Get current user
    const userProfile = JSON.parse(localStorage.getItem('afcon2025_user_profile'));
    const adminSession = JSON.parse(localStorage.getItem('afcon2025_admin_session'));
    
    // Determine user ID
    let userId = 'guest';
    if (userProfile) {
        userId = userProfile.avatarSeed;
    } else if (adminSession && adminSession.loggedIn) {
        userId = adminSession.username.toLowerCase();
    } else {
        // Guest users need to sign in
        if (confirm('Please sign in to save your predictions! Would you like to sign in now?')) {
            document.getElementById('loginModal').classList.add('active');
        }
        return;
    }
    
    // Get all predictions
    const allPredictions = JSON.parse(localStorage.getItem('afcon2025_all_predictions')) || {};
    
    // Get user's predictions
    const userPredictions = allPredictions[userId] || [];
    
    // Add new prediction
    userPredictions.unshift(data);
    
    // Keep only last 10 predictions
    if (userPredictions.length > 10) {
        userPredictions.length = 10;
    }
    
    // Save back to all predictions
    allPredictions[userId] = userPredictions;
    localStorage.setItem('afcon2025_all_predictions', JSON.stringify(allPredictions));
    
    // Update saved predictions list
    loadSavedPredictions();
    
    alert('Predictions saved successfully!');
    
    const saveBtn = document.getElementById('saveBtn');
    saveBtn.classList.add('save-animation');
    setTimeout(() => saveBtn.classList.remove('save-animation'), 500);
}

// Initialize saved predictions on page load
loadSavedPredictions();
    </script>
</body>
</html>